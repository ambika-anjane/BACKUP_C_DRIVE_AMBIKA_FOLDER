
--AUDIT LOGS
-- unique test
select
 integration_id as unique_field,
    count(*) as n_records
from "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F"
group by integration_id
having count(*) > 1



-- audit logs 
select * from "DEV_EDW"."EDW_METADATA"."EL_AUDIT_BALANCE_LOG" where node_name = 'w_sales_invoice_line_f'


-- TRACH BATCH
SELECT * FROM "DEV_EDW"."EDW_METADATA"."EL_BATCH_REFRESH_TRACKER" WHERE TABLE_NAME = 'w_sales_invoice_line_f'


select UOM_CODE from "DEV_DISCOVER"."FINANCIALS"."STG_ORACLE__RA_CUSTOMER_TRX_LINES_ALL" WHERE CUSTOMER_TRX_LINE_ID
 = 5790175 
 SELECT DISTINCT(UOM_CODE) FROM "DEV_DISCOVER"."FINANCIALS"."STG_ORACLE__RA_CUSTOMER_TRX_LINES_ALL" WHERE CUSTOMER_TRX_LINE_ID
 = 5790175 
 select CUSTOMER_TRX_LINE_ID from "DEV_DISCOVER"."FINANCIALS"."STG_ORACLE__RA_CUSTOMER_TRX_LINES_ALL"  WHERE CUSTOMER_TRX_LINE_ID
 = 5790175 

AND ITEM_ID  IN (SELECT ITEM_ID FROM "DEV_ODS"."ORACLE_SCP"."SALES_DATA")
SELECT ITEM_ID,BUDGET FROM "DEV_ODS"."ORACLE_SCP"."SALES_DATA" WHERE ITEM_ID = 13954  AND SALES_DATE = '2021-02-01 00:00:00.000'
DESC TABLE "DEV_EDW"."EDW_OMNI"."W_DM_FORECAST_F"
--UPDATE INCREMENTAL TEST


SELECT * FROM "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_LINES_ALL"  WHERE CUSTOMER_TRX_LINE_ID
 = 5790175 
SELECT BILL_TO_CONTACT_ID FROM   "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_ALL" WHERE CUSTOMER_TRX_ID = 5790175
UPDATE "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_ALL"   SET BILL_TO_CONTACT_ID
  =87 WHERE CUSTOMER_TRX_ID = 5790175
UPDATE "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_ALL"  SET _batch_update_date = CURRENT_TIMESTAMP() WHERE CUSTOMER_TRX_ID = 5790175
SELECT interface_line_attribute11  FROM  "DEV_DISCOVER"."FINANCIALS"."STG_ORACLE__RA_CUSTOMER_TRX_ALL"
SELECT CUSTOMER_ACCOUNT_ID FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F" WHERE INVOICE_HEADER_ID  =  5790175
SELECT INTEGRATION_ID,W_INSERT_DT,W_UPDATE_DT FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F" ORDER BY INTEGRATION_ID ASC

SELECT INTEGRATION_ID,W_INSERT_DT,W_UPDATE_DT FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F"  where  INTEGRATION_ID = 110387064

DELETE FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F" WHERE  INTEGRATION_ID = 110387064
UPDATE "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_LINES_ALL"  SET _batch_update_date = CURRENT_TIMESTAMP() WHERE CUSTOMER_TRX_LINE_ID
 = 1174290
 UPDATE "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_LINES_ALL"  SET interface_line_attribute6 = NULL WHERE CUSTOMER_TRX_LINE_ID
 = 1174290 
 SELECT interface_line_attribute6 FROM  "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_LINES_ALL" WHERE   CUSTOMER_TRX_LINE_ID = 1174290
 select  fulfill_line_id,W_UPDATE_DT from "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F" WHERE  INTEGRATION_ID =1174290

 
 UPDATE "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_ALL"   SET BILL_TO_CONTACT_ID
  = 7 WHERE CUSTOMER_TRX_ID = 5790175
select * from "ORACLE_FINANCIALS"."RA_CUSTOMER_TRX_LINES_ALL" where CUSTOMER_TRX_LINE_ID = 110387064
DROP TABLE  "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F"
SELECT COUNT(*) FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F"


 
SELECT count(*) FROM "DEV_EDW"."EDW_OMNI"."W_SALES_INVOICE_LINE_F"
WHERE  INTEGRATION_ID = 5790175
select ITEM_ID,BUDGET from "DEV_ODS"."ORACLE_SCP"."SALES_DATA" WHERE ITEM_ID = 13954  AND SALES_DATE = '2021-02-01 00:00:00.000'

UPDATE ORACLE_MASTER_DATA.HZ_CUST_SITE_USES_ALL    SET _batch_update_date = CURRENT_TIMESTAMP() WHERE SITE_USE_ID = 7943537
