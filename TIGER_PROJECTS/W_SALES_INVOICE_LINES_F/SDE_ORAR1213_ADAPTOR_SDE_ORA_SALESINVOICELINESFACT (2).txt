



/* Db link option chosen and SDS not deployed */
create or replace view APPS.C$_4993650864_2_0
(
	C1_SALES_ORDLN_ID,
	C2_SALES_PCKLN_ID,
	C3_INVENTORY_ORG_ID,
	C4_INVENTORY_PRODUCT_ID,
	C5_INVOICE_STATUS_ID,
	C6_OPERATING_UNIT_ORG_ID,
	C7_PAYMENT_TERMS_ID,
	C8_PLANT_LOC_ID,
	C9_PRODUCT_ID,
	C10_SALES_ORG_ID,
	C11_SALES_PRODUCT_ID,
	C12_TERR_ID,
	C13_XACT_TYPE_ID,
	C14_CONVERSION_DT,
	C15_INVOICED_ON_DT,
	C16_PAYMENT_TERMS_EFF_DT,
	C17_NET_AMT,
	C18_LIST_AMT,
	C19_TAX_AMT,
	C20_FREIGHT_AMT,
	C21_DISCOUNT_AMT,
	C22_INVOICED_QTY,
	C23_INVOICE_NUM,
	C24_INVOICE_ITEM,
	C25_SALES_ORDER_NUM,
	C26_SALES_ORDER_ITEM,
	C27_SALES_ORDER_ITEM_DETAIL_NU,
	C28_PURCH_ORDER_NUM,
	C29_DELETE_FLG,
	C30_LOC_EXCH_RATE_TYPE,
	C31_LOC_EXCHANGE_RATE,
	C32_EXCHANGE_DT,
	C33_CREATED_BY_ID,
	C34_CHANGED_BY_ID,
	C35_CREATED_ON_DT,
	C36_CHANGED_ON_DT,
	C37_AUX1_CHANGED_ON_DT,
	C38_AUX2_CHANGED_ON_DT,
	C39_INTEGRATION_ID,
	C40_LEDGER_ID,
	C41_CUSTOMER_ACCOUNT_ID,
	C42_XACT_SOURCE_ID,
	C43_FULFILL_LINE_ID,
	C44_INVOICE_HEADER_ID,
	C45_LEGAL_ENTITY_ID,
	C46_SALESREP_ID,
	C47_UOM_CODE,
	C48_INVOICE_CURRENCY_CODE,
	C49_LOC_CURR_CODE,
	C50_INTERFACE_LINE_ATTRIBUTE11,
	C51_TYPE,
	C52_SOLD_TO_SITE_USE_ID,
	C53_PAYING_SITE_USE_ID,
	C54_BILL_TO_SITE_USE_ID,
	C55_SHIP_TO_SITE_USE_ID
)
as select	
	
	(CASE
WHEN SQ_BCI_SALES_IVCLNS.LINE_TYPE='DM' THEN 
NULL
ELSE 
(CASE
WHEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1
	
END )='ORDER ENTRY' THEN  
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE6
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE61
	
END )
ELSE 
	NULL

END )

END )	   C1_SALES_ORDLN_ID,
	(CASE
WHEN SQ_BCI_SALES_IVCLNS.LINE_TYPE='DM' THEN 
NULL
ELSE 
(CASE
WHEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1
	
END )='ORDER ENTRY'  THEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE7
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE71
	
END )
ELSE 
	NULL

END )

END )	   C2_SALES_PCKLN_ID,
	TO_CHAR( 
(CASE
WHEN SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN   
       SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID
ELSE  
       SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID1 
END )
)
	   C3_INVENTORY_ORG_ID,
	TO_CHAR(
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID
ELSE 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID1
	
END )
)||'~'||TO_CHAR(
	(CASE
WHEN 
		 SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID
ELSE 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID1
		
END )
)	   C4_INVENTORY_PRODUCT_ID,
	'SALES_ORDER_INVOICE_PROCESS'||'~'||SQ_BCI_SALES_IVCLNS.STATUS_TRX	   C5_INVOICE_STATUS_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.ORG_ID)	   C6_OPERATING_UNIT_ORG_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.TERM_ID)	   C7_PAYMENT_TERMS_ID,
	'PLANT'||'~'||TO_CHAR(
			(CASE
WHEN 
			SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE'OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID
ELSE 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID1
		
END )
	)
	   C8_PLANT_LOC_ID,
	TO_CHAR(
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID
ELSE 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID1
	
END )
)	   C9_PRODUCT_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.ORG_ID)	   C10_SALES_ORG_ID,
	TO_CHAR(
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID
ELSE 
		SQ_BCI_SALES_IVCLNS.INVENTORY_ITEM_ID1
	
END )
) ||'~'||TO_CHAR(
		(CASE
WHEN 
			SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID
ELSE 
			SQ_BCI_SALES_IVCLNS.WAREHOUSE_ID1
		
END )
)	   C11_SALES_PRODUCT_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.TERRITORY_ID)	   C12_TERR_ID,
	'SALES_IVCLNS'||'~'||TO_CHAR(SQ_BCI_SALES_IVCLNS.TYPE)	   C13_XACT_TYPE_ID,
	SQ_BCI_SALES_IVCLNS.EXCHANGE_DATE	   C14_CONVERSION_DT,
	SQ_BCI_SALES_IVCLNS.TRX_DATE	   C15_INVOICED_ON_DT,
	SQ_BCI_SALES_IVCLNS.TERM_DUE_DATE	   C16_PAYMENT_TERMS_EFF_DT,
	(CASE
WHEN (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT
ELSE  0
END )	   C17_NET_AMT,
	(CASE
WHEN 
   (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  
  SQ_BCI_SALES_IVCLNS.QUANTITY_INVOICED*
	((CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE IS NULL THEN  
      		  0
ELSE  
       		 TO_NUMBER(SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE)
       		
END ) 
      	)
ELSE  
   0
   
END )	   C18_LIST_AMT,
	(CASE
WHEN 
	SQ_BCI_SALES_IVCLNS.LINE_TYPE='TAX' THEN 
	SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT
ELSE 
	0

END ) 	   C19_TAX_AMT,
	(CASE
WHEN 
	SQ_BCI_SALES_IVCLNS.LINE_TYPE='FREIGHT' THEN 
	SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT
ELSE 
	0

END )	   C20_FREIGHT_AMT,
	  (CASE
WHEN (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE' OR SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL) AND 
   SQ_BCI_SALES_IVCLNS.QUANTITY_INVOICED > 0 AND SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT > 0 AND 
	SQ_BCI_SALES_IVCLNS.TYPE <> 'CM' THEN  
    (CASE
WHEN (CASE
WHEN 
   (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  
  SQ_BCI_SALES_IVCLNS.QUANTITY_INVOICED*
	((CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE IS NULL THEN  
      		  0
ELSE  
       		 TO_NUMBER(SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE)
       		
END ) 
      	)
ELSE  
   0
   
END ) 
	> 
	(CASE
WHEN (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT
ELSE  0
END ) THEN  
     		(CASE
WHEN 
   (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  
  SQ_BCI_SALES_IVCLNS.QUANTITY_INVOICED*
	((CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE IS NULL THEN  
      		  0
ELSE  
       		 TO_NUMBER(SQ_BCI_SALES_IVCLNS.UNIT_STANDARD_PRICE)
       		
END ) 
      	)
ELSE  
   0
   
END ) 
		- 
		(CASE
WHEN (SQ_BCI_SALES_IVCLNS.LINE_TYPE = 'LINE') OR (SQ_BCI_SALES_IVCLNS.LINE_TYPE= 'CB') THEN  SQ_BCI_SALES_IVCLNS.EXTENDED_AMOUNT
ELSE  0
END )
ELSE  
     		0
   	 
END )
ELSE 
    0
  
END )	   C21_DISCOUNT_AMT,
	SQ_BCI_SALES_IVCLNS.QUANTITY_INVOICED	   C22_INVOICED_QTY,
	SQ_BCI_SALES_IVCLNS.TRX_NUMBER	   C23_INVOICE_NUM,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.LINE_NUMBER)	   C24_INVOICE_ITEM,
	(CASE
WHEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1
	
END )='ORDER ENTRY' THEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' THEN 
		SQ_BCI_SALES_IVCLNS.SALES_ORDER
ELSE 
		SQ_BCI_SALES_IVCLNS.SALES_ORDER1
	
END )
ELSE 
	NULL

END )	   C25_SALES_ORDER_NUM,
	(CASE
WHEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT
ELSE 
		SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1
	
END )='ORDER ENTRY'  THEN 
	(CASE
WHEN 
		SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' THEN 
		SQ_BCI_SALES_IVCLNS.SALES_ORDER_LINE
ELSE 
		SQ_BCI_SALES_IVCLNS.SALES_ORDER_LINE1
	
END )
ELSE 
	NULL

END )
	   C26_SALES_ORDER_ITEM,
	(CASE
WHEN  
 (CASE
WHEN SQ_BCI_SALES_IVCLNS.LINE_TYPE='LINE' OR SQ_BCI_SALES_IVCLNS.LINK_TO_CUST_TRX_LINE_ID IS NULL THEN  
      SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT
ELSE  
      SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1 
 
END )='ORDER ENTRY' THEN  
(CASE
WHEN  SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE13 IS NULL THEN  
           TRIM(TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE12))
ELSE  
        TRIM(TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE12))||'.'||
        TRIM(TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE13))
      
END )
ELSE  
NULL 
END )
	   C27_SALES_ORDER_ITEM_DETAIL_NU,
	SQ_BCI_SALES_IVCLNS.PURCHASE_ORDER	   C28_PURCH_ORDER_NUM,
	SQ_BCI_SALES_IVCLNS.DELETE_FLG	   C29_DELETE_FLG,
	SQ_BCI_SALES_IVCLNS.EXCHANGE_RATE_TYPE	   C30_LOC_EXCH_RATE_TYPE,
	SQ_BCI_SALES_IVCLNS.EXCHANGE_RATE	   C31_LOC_EXCHANGE_RATE,
	(CASE
WHEN 
	SQ_BCI_SALES_IVCLNS.EXCHANGE_DATE IS NULL THEN 
	SQ_BCI_SALES_IVCLNS.TRX_DATE
ELSE 
	SQ_BCI_SALES_IVCLNS.EXCHANGE_DATE

END )
		   C32_EXCHANGE_DT,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.CREATED_BY)	   C33_CREATED_BY_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.LAST_UPDATED_BY)	   C34_CHANGED_BY_ID,
	SQ_BCI_SALES_IVCLNS.CREATION_DATE	   C35_CREATED_ON_DT,
	SQ_BCI_SALES_IVCLNS.LAST_UPDATE_DATE	   C36_CHANGED_ON_DT,
	SQ_BCI_SALES_IVCLNS.LAST_UPDATE_DATE1	   C37_AUX1_CHANGED_ON_DT,
	SQ_BCI_SALES_IVCLNS.LAST_UPDATE_DATE2	   C38_AUX2_CHANGED_ON_DT,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.CUSTOMER_TRX_LINE_ID)	   C39_INTEGRATION_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.SET_OF_BOOKS_ID)	   C40_LEDGER_ID,
	TO_CHAR(SQ_BCI_SALES_IVCLNS.BILL_TO_CUSTOMER_ID)	   C41_CUSTOMER_ACCOUNT_ID,
	'SALES_IVCLNS~' || 
(CASE
WHEN 
	TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT) IS NULL THEN  
		TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT1)
ELSE 
		TO_CHAR(SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_CONTEXT)

END )
	   C42_XACT_SOURCE_ID,
	SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE6	   C43_FULFILL_LINE_ID,
	SQ_BCI_SALES_IVCLNS.CUSTOMER_TRX_ID	   C44_INVOICE_HEADER_ID,
	SQ_BCI_SALES_IVCLNS.LEGAL_ENTITY_ID	   C45_LEGAL_ENTITY_ID,
	SQ_BCI_SALES_IVCLNS.SALESREP_ID	   C46_SALESREP_ID,
	SQ_BCI_SALES_IVCLNS.UOM_CODE	   C47_UOM_CODE,
	SQ_BCI_SALES_IVCLNS.INVOICE_CURRENCY_CODE	   C48_INVOICE_CURRENCY_CODE,
	SQ_BCI_SALES_IVCLNS.LOC_CURR_CODE	   C49_LOC_CURR_CODE,
	SQ_BCI_SALES_IVCLNS.INTERFACE_LINE_ATTRIBUTE11	   C50_INTERFACE_LINE_ATTRIBUTE11,
	SQ_BCI_SALES_IVCLNS.TYPE	   C51_TYPE,
	SQ_BCI_SALES_IVCLNS.SOLD_TO_SITE_USE_ID	   C52_SOLD_TO_SITE_USE_ID,
	SQ_BCI_SALES_IVCLNS.PAYING_SITE_USE_ID	   C53_PAYING_SITE_USE_ID,
	SQ_BCI_SALES_IVCLNS.BILL_TO_SITE_USE_ID	   C54_BILL_TO_SITE_USE_ID,
	SQ_BCI_SALES_IVCLNS.SHIP_TO_SITE_USE_ID	   C55_SHIP_TO_SITE_USE_ID
from	
( /* Subselect from SDE_ORA_SalesInvoiceLinesFact.W_SALES_INVOICE_LINE_FS.SQ_BCI_SALES_IVCLNS
*/


select 
	  

	   
	   RA_CUST_TRX_TYPES_ALL.TYPE TYPE,
	RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_LINE_ID CUSTOMER_TRX_LINE_ID,
	
 
RA_CUSTOMER_TRX_LINES_ALL.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	RA_CUSTOMER_TRX_LINES_ALL.LAST_UPDATED_BY LAST_UPDATED_BY,
	RA_CUSTOMER_TRX_LINES_ALL.CREATION_DATE CREATION_DATE,
	RA_CUSTOMER_TRX_LINES_ALL.CREATED_BY CREATED_BY,
	RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_ID CUSTOMER_TRX_ID1,
	RA_CUSTOMER_TRX_LINES_ALL.LINE_NUMBER LINE_NUMBER,
	RA_CUSTOMER_TRX_LINES_ALL.SET_OF_BOOKS_ID SET_OF_BOOKS_ID,
	RA_CUSTOMER_TRX_LINES_ALL.INVENTORY_ITEM_ID INVENTORY_ITEM_ID,
	(CASE WHEN 
  RA_CUSTOMER_TRX_LINES_ALL.LINE_TYPE = 'TAX' OR RA_CUSTOMER_TRX_LINES_ALL.LINE_TYPE = 'FREIGHT' 
  THEN NULL
  ELSE
	(CASE WHEN RA_CUST_TRX_TYPES_ALL.TYPE = 'CM'
		THEN -1*COALESCE(RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_CREDITED,0) 
  		ELSE 
			(CASE WHEN RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE11 IS NOT NULL AND RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE11 <>'0' 
				THEN RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_INVOICED
		 		ELSE (CASE WHEN RA_CUSTOMER_TRX_LINES_ALL.UNIT_SELLING_PRICE < 0 AND COALESCE(RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_INVOICED,0) > 0
    					THEN -1*COALESCE(RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_INVOICED,0)
					ELSE COALESCE(RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_INVOICED,0)
				 END)
 			END)
	END)
END) QUANTITY_INVOICED,
	COALESCE(RA_CUSTOMER_TRX_LINES_ALL.QUANTITY_CREDITED,0) QUANTITY_CREDITED,
	(CASE
WHEN NOT RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE11 IS NULL AND 
RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE11 <> '0'  THEN  
NULL
ELSE   
(CASE WHEN RA_CUST_TRX_TYPES_ALL.TYPE = 'CM' THEN -1*RA_CUSTOMER_TRX_LINES_ALL.UNIT_STANDARD_PRICE ELSE RA_CUSTOMER_TRX_LINES_ALL.UNIT_STANDARD_PRICE END)
END ) UNIT_STANDARD_PRICE,
	RA_CUSTOMER_TRX_LINES_ALL.UNIT_SELLING_PRICE UNIT_SELLING_PRICE,
	RA_CUSTOMER_TRX_LINES_ALL.SALES_ORDER SALES_ORDER,
	RA_CUSTOMER_TRX_LINES_ALL.SALES_ORDER_LINE SALES_ORDER_LINE,
	RA_CUSTOMER_TRX_LINES_ALL.LINE_TYPE LINE_TYPE,
	CASE WHEN RA_CUST_TRX_TYPES_ALL.TYPE = 'CM'
	THEN -1*RA_CUSTOMER_TRX_LINES_ALL.EXTENDED_AMOUNT
	ELSE RA_CUSTOMER_TRX_LINES_ALL.EXTENDED_AMOUNT END EXTENDED_AMOUNT,
	RA_CUSTOMER_TRX_LINES_ALL.TAX_RATE TAX_RATE,
	RA_CUSTOMER_TRX_LINES_ALL.UOM_CODE UOM_CODE,
	RA_CUSTOMER_TRX_LINES_ALL.ORG_ID ORG_ID,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_CONTEXT INTERFACE_LINE_CONTEXT,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE6 INTERFACE_LINE_ATTRIBUTE6,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE7 INTERFACE_LINE_ATTRIBUTE7,
	RA_CUSTOMER_TRX_LINES_ALL.LINK_TO_CUST_TRX_LINE_ID LINK_TO_CUST_TRX_LINE_ID,
	RA_CUSTOMER_TRX_LINES_ALL.WAREHOUSE_ID WAREHOUSE_ID,
	RA_CUSTOMER_TRX_ALL.CUSTOMER_TRX_ID CUSTOMER_TRX_ID,
	RA_CUSTOMER_TRX_ALL.TRX_NUMBER TRX_NUMBER,
	RA_CUSTOMER_TRX_ALL.CUST_TRX_TYPE_ID CUST_TRX_TYPE_ID,
	RA_CUSTOMER_TRX_ALL.TRX_DATE TRX_DATE,
	RA_CUSTOMER_TRX_ALL.SOLD_TO_CUSTOMER_ID SOLD_TO_CUSTOMER_ID,
	RA_CUSTOMER_TRX_ALL.SOLD_TO_SITE_USE_ID SOLD_TO_SITE_USE_ID,
	RA_CUSTOMER_TRX_ALL.BILL_TO_CUSTOMER_ID BILL_TO_CUSTOMER_ID,
	RA_CUSTOMER_TRX_ALL.BILL_TO_SITE_USE_ID BILL_TO_SITE_USE_ID,
	RA_CUSTOMER_TRX_ALL.SHIP_TO_SITE_USE_ID SHIP_TO_SITE_USE_ID,
	RA_CUSTOMER_TRX_ALL.SHIP_TO_CUSTOMER_ID SHIP_TO_CUSTOMER_ID,
	RA_CUSTOMER_TRX_ALL.TERM_ID TERM_ID,
	RA_CUSTOMER_TRX_ALL.TERM_DUE_DATE TERM_DUE_DATE,
	RA_SALESREPS_ALL.RESOURCE_ID SALESREP_ID,
	RA_CUSTOMER_TRX_ALL.PRINTING_ORIGINAL_DATE PRINTING_ORIGINAL_DATE,
	RA_CUSTOMER_TRX_ALL.PURCHASE_ORDER PURCHASE_ORDER,
	RA_CUSTOMER_TRX_ALL.EXCHANGE_DATE EXCHANGE_DATE,
	RA_CUSTOMER_TRX_ALL.EXCHANGE_RATE EXCHANGE_RATE,
	RA_CUSTOMER_TRX_ALL.TERRITORY_ID TERRITORY_ID,
	RA_CUSTOMER_TRX_ALL.INVOICE_CURRENCY_CODE INVOICE_CURRENCY_CODE,
	RA_CUSTOMER_TRX_ALL.COMPLETE_FLAG COMPLETE_FLAG,
	RA_CUSTOMER_TRX_ALL.PAYING_SITE_USE_ID PAYING_SITE_USE_ID,
	RA_CUSTOMER_TRX_LINES_ALL1.CUSTOMER_TRX_LINE_ID CUSTOMER_TRX_LINE_ID1,
	RA_CUSTOMER_TRX_LINES_ALL1.INVENTORY_ITEM_ID INVENTORY_ITEM_ID1,
	RA_CUSTOMER_TRX_LINES_ALL1.SALES_ORDER SALES_ORDER1,
	RA_CUSTOMER_TRX_LINES_ALL1.SALES_ORDER_LINE SALES_ORDER_LINE1,
	RA_CUSTOMER_TRX_LINES_ALL1.INTERFACE_LINE_CONTEXT INTERFACE_LINE_CONTEXT1,
	RA_CUSTOMER_TRX_LINES_ALL1.INTERFACE_LINE_ATTRIBUTE6 INTERFACE_LINE_ATTRIBUTE61,
	RA_CUSTOMER_TRX_LINES_ALL1.INTERFACE_LINE_ATTRIBUTE7 INTERFACE_LINE_ATTRIBUTE71,
	RA_CUSTOMER_TRX_LINES_ALL1.WAREHOUSE_ID WAREHOUSE_ID1,
	RA_CUSTOMER_TRX_ALL.STATUS_TRX STATUS_TRX,
	RA_CUSTOMER_TRX_ALL.EXCHANGE_RATE_TYPE EXCHANGE_RATE_TYPE,
	
 
RA_CUSTOMER_TRX_ALL.LAST_UPDATE_DATE
 LAST_UPDATE_DATE1,
	
 
RA_CUST_TRX_TYPES_ALL.LAST_UPDATE_DATE
 LAST_UPDATE_DATE2,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE11 INTERFACE_LINE_ATTRIBUTE11,
	RA_CUSTOMER_TRX_LINES_ALL1.INTERFACE_LINE_ATTRIBUTE5 INTERFACE_LINE_ATTRIBUTE5,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE12 INTERFACE_LINE_ATTRIBUTE12,
	RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_ATTRIBUTE13 INTERFACE_LINE_ATTRIBUTE13,
	GL_LEDGERS.CURRENCY_CODE LOC_CURR_CODE,
	RA_CUSTOMER_TRX_ALL.LEGAL_ENTITY_ID LEGAL_ENTITY_ID,
	

   'N'
 DELETE_FLG
from	((((APPS.RA_CUSTOMER_TRX_ALL    RA_CUSTOMER_TRX_ALL INNER JOIN APPS.RA_CUSTOMER_TRX_LINES_ALL    RA_CUSTOMER_TRX_LINES_ALL ON RA_CUSTOMER_TRX_ALL.CUSTOMER_TRX_ID=RA_CUSTOMER_TRX_LINES_ALL.CUSTOMER_TRX_ID) INNER JOIN APPS.RA_CUST_TRX_TYPES_ALL    RA_CUST_TRX_TYPES_ALL ON RA_CUSTOMER_TRX_ALL.ORG_ID=RA_CUST_TRX_TYPES_ALL.ORG_ID AND RA_CUSTOMER_TRX_ALL.CUST_TRX_TYPE_ID=RA_CUST_TRX_TYPES_ALL.CUST_TRX_TYPE_ID) INNER JOIN APPS.RA_SALESREPS_ALL    RA_SALESREPS_ALL ON RA_CUSTOMER_TRX_ALL.PRIMARY_SALESREP_ID=RA_SALESREPS_ALL.SALESREP_ID AND RA_CUSTOMER_TRX_ALL.ORG_ID=RA_SALESREPS_ALL.ORG_ID) LEFT OUTER JOIN APPS.RA_CUSTOMER_TRX_LINES_ALL    RA_CUSTOMER_TRX_LINES_ALL1 ON RA_CUSTOMER_TRX_LINES_ALL.LINK_TO_CUST_TRX_LINE_ID=RA_CUSTOMER_TRX_LINES_ALL1.CUSTOMER_TRX_LINE_ID) INNER JOIN APPS.GL_LEDGERS    GL_LEDGERS ON RA_CUSTOMER_TRX_LINES_ALL.SET_OF_BOOKS_ID=GL_LEDGERS.LEDGER_ID
where	(1=1)

And (

	

(RA_CUSTOMER_TRX_ALL.LAST_UPDATE_DATE>=TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
OR RA_CUSTOMER_TRX_LINES_ALL.LAST_UPDATE_DATE>=TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))


)
 And (RA_CUSTOMER_TRX_ALL.COMPLETE_FLAG='Y')
 And (RA_CUSTOMER_TRX_LINES_ALL.INTERFACE_LINE_CONTEXT IN ('ORDER ENTRY','INTERCOMPANY','CRS') OR RA_CUSTOMER_TRX_LINES_ALL1.INTERFACE_LINE_CONTEXT IN ('ORDER ENTRY','INTERCOMPANY','CRS'))







)   SQ_BCI_SALES_IVCLNS
where	(1=1)


/******************************************************************************************************/

  
insert  into	BI11G_DW.W_SALES_INVOICE_LINE_FS 
( 
	SALES_ORDLN_ID,
	SALES_PCKLN_ID,
	COMPANY_ORG_ID,
	CUSTOMER_BILL_TO_LOC_ID,
	CUSTOMER_PAYER_LOC_ID,
	CUSTOMER_SHIP_TO_LOC_ID,
	CUSTOMER_SOLD_TO_LOC_ID,
	INVENTORY_ORG_ID,
	INVENTORY_PRODUCT_ID,
	INVOICE_STATUS_ID,
	OPERATING_UNIT_ORG_ID,
	PAYMENT_TERMS_ID,
	PLANT_LOC_ID,
	PRODUCT_ID,
	SALES_ORG_ID,
	SALES_PRODUCT_ID,
	SALES_REP_ID,
	TERR_ID,
	XACT_TYPE_ID,
	CONVERSION_DT,
	INVOICED_ON_DT,
	PAYMENT_TERMS_EFF_DT,
	NET_AMT,
	LIST_AMT,
	TAX_AMT,
	FREIGHT_AMT,
	DISCOUNT_AMT,
	INVOICED_QTY,
	SALES_UOM_CODE,
	INVOICE_NUM,
	INVOICE_ITEM,
	SALES_ORDER_NUM,
	SALES_ORDER_ITEM,
	SALES_ORDER_ITEM_DETAIL_NUM,
	PURCH_ORDER_NUM,
	DELETE_FLG,
	DOC_CURR_CODE,
	LOC_CURR_CODE,
	LOC_EXCH_RATE_TYPE,
	LOC_EXCHANGE_RATE,
	EXCHANGE_DT,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	AUX1_CHANGED_ON_DT,
	AUX2_CHANGED_ON_DT,
	AUX4_CHANGED_ON_DT,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID,
	LEDGER_ID,
	DISCOUNT_LINE_FLG,
	CUSTOMER_ACCOUNT_ID,
	XACT_SOURCE_ID,
	FULFILL_LINE_ID,
	INVOICE_HEADER_ID 
	,REJECT_FLG,
	TENANT_ID,
	X_CUSTOM 
) 

select	
	SALES_ORDLN_ID,
	SALES_PCKLN_ID,
	COMPANY_ORG_ID,
	CUSTOMER_BILL_TO_LOC_ID,
	CUSTOMER_PAYER_LOC_ID,
	CUSTOMER_SHIP_TO_LOC_ID,
	CUSTOMER_SOLD_TO_LOC_ID,
	INVENTORY_ORG_ID,
	INVENTORY_PRODUCT_ID,
	INVOICE_STATUS_ID,
	OPERATING_UNIT_ORG_ID,
	PAYMENT_TERMS_ID,
	PLANT_LOC_ID,
	PRODUCT_ID,
	SALES_ORG_ID,
	SALES_PRODUCT_ID,
	SALES_REP_ID,
	TERR_ID,
	XACT_TYPE_ID,
	CONVERSION_DT,
	INVOICED_ON_DT,
	PAYMENT_TERMS_EFF_DT,
	NET_AMT,
	LIST_AMT,
	TAX_AMT,
	FREIGHT_AMT,
	DISCOUNT_AMT,
	INVOICED_QTY,
	SALES_UOM_CODE,
	INVOICE_NUM,
	INVOICE_ITEM,
	SALES_ORDER_NUM,
	SALES_ORDER_ITEM,
	SALES_ORDER_ITEM_DETAIL_NUM,
	PURCH_ORDER_NUM,
	DELETE_FLG,
	DOC_CURR_CODE,
	LOC_CURR_CODE,
	LOC_EXCH_RATE_TYPE,
	LOC_EXCHANGE_RATE,
	EXCHANGE_DT,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	AUX1_CHANGED_ON_DT,
	AUX2_CHANGED_ON_DT,
	AUX4_CHANGED_ON_DT,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID,
	LEDGER_ID,
	DISCOUNT_LINE_FLG,
	CUSTOMER_ACCOUNT_ID,
	XACT_SOURCE_ID,
	FULFILL_LINE_ID,
	INVOICE_HEADER_ID
	,'N',
	'#BIAPPS.TENANT_ID',
	'0'
FROM (	


select 	
	
	C1_SALES_ORDLN_ID SALES_ORDLN_ID,
	C2_SALES_PCKLN_ID SALES_PCKLN_ID,
	'COMPANY'||'~'||TO_CHAR(C45_LEGAL_ENTITY_ID) COMPANY_ORG_ID,
	LKP_W_CUST_LOC_USE_PS_INVC.ACCT_SITE_ID CUSTOMER_BILL_TO_LOC_ID,
	LKP_W_CUST_LOC_USE_PS_PYR.ACCT_SITE_ID CUSTOMER_PAYER_LOC_ID,
	LKP_W_CUST_LOC_USE_PS_SHP.ACCT_SITE_ID CUSTOMER_SHIP_TO_LOC_ID,
	LKP_W_CUST_LOC_USE_PS_SLD.ACCT_SITE_ID CUSTOMER_SOLD_TO_LOC_ID,
	C3_INVENTORY_ORG_ID INVENTORY_ORG_ID,
	C4_INVENTORY_PRODUCT_ID INVENTORY_PRODUCT_ID,
	C5_INVOICE_STATUS_ID INVOICE_STATUS_ID,
	C6_OPERATING_UNIT_ORG_ID OPERATING_UNIT_ORG_ID,
	C7_PAYMENT_TERMS_ID PAYMENT_TERMS_ID,
	C8_PLANT_LOC_ID PLANT_LOC_ID,
	C9_PRODUCT_ID PRODUCT_ID,
	C10_SALES_ORG_ID SALES_ORG_ID,
	C11_SALES_PRODUCT_ID SALES_PRODUCT_ID,
	TO_CHAR(C46_SALESREP_ID) SALES_REP_ID,
	C12_TERR_ID TERR_ID,
	C13_XACT_TYPE_ID XACT_TYPE_ID,
	C14_CONVERSION_DT CONVERSION_DT,
	C15_INVOICED_ON_DT INVOICED_ON_DT,
	C16_PAYMENT_TERMS_EFF_DT PAYMENT_TERMS_EFF_DT,
	C17_NET_AMT NET_AMT,
	C18_LIST_AMT LIST_AMT,
	C19_TAX_AMT TAX_AMT,
	C20_FREIGHT_AMT FREIGHT_AMT,
	C21_DISCOUNT_AMT DISCOUNT_AMT,
	C22_INVOICED_QTY INVOICED_QTY,
	COALESCE(C47_UOM_CODE,'__UNASSIGNED__') SALES_UOM_CODE,
	C23_INVOICE_NUM INVOICE_NUM,
	C24_INVOICE_ITEM INVOICE_ITEM,
	C25_SALES_ORDER_NUM SALES_ORDER_NUM,
	C26_SALES_ORDER_ITEM SALES_ORDER_ITEM,
	C27_SALES_ORDER_ITEM_DETAIL_NU SALES_ORDER_ITEM_DETAIL_NUM,
	C28_PURCH_ORDER_NUM PURCH_ORDER_NUM,
	C29_DELETE_FLG DELETE_FLG,
	COALESCE(C48_INVOICE_CURRENCY_CODE,'__UNASSIGNED__') DOC_CURR_CODE,
	COALESCE(C49_LOC_CURR_CODE,'__UNASSIGNED__') LOC_CURR_CODE,
	C30_LOC_EXCH_RATE_TYPE LOC_EXCH_RATE_TYPE,
	C31_LOC_EXCHANGE_RATE LOC_EXCHANGE_RATE,
	C32_EXCHANGE_DT EXCHANGE_DT,
	C33_CREATED_BY_ID CREATED_BY_ID,
	C34_CHANGED_BY_ID CHANGED_BY_ID,
	C35_CREATED_ON_DT CREATED_ON_DT,
	C36_CHANGED_ON_DT CHANGED_ON_DT,
	C37_AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	C38_AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	GREATEST(
COALESCE(LKP_W_CUST_LOC_USE_PS_SHP.AUX1_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SHP.AUX2_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SHP.AUX3_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SHP.AUX4_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SHP.CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_PYR.AUX1_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_PYR.AUX2_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_PYR.AUX3_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_PYR.AUX4_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_PYR.CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_INVC.AUX1_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_INVC.AUX2_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_INVC.AUX3_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_INVC.AUX4_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_INVC.CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SLD.AUX1_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SLD.AUX2_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SLD.AUX3_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SLD.AUX4_CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')),
COALESCE(LKP_W_CUST_LOC_USE_PS_SLD.CHANGED_ON_DT,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))
) AUX4_CHANGED_ON_DT,
	#BIAPPS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	C39_INTEGRATION_ID INTEGRATION_ID,
	C40_LEDGER_ID LEDGER_ID,
	(CASE
WHEN NOT C50_INTERFACE_LINE_ATTRIBUTE11 IS NULL AND C50_INTERFACE_LINE_ATTRIBUTE11 <> '0' AND C51_TYPE='INV' THEN 'Y'
ELSE 'N'
END ) DISCOUNT_LINE_FLG,
	C41_CUSTOMER_ACCOUNT_ID CUSTOMER_ACCOUNT_ID,
	C42_XACT_SOURCE_ID XACT_SOURCE_ID,
	C43_FULFILL_LINE_ID FULFILL_LINE_ID,
	C44_INVOICE_HEADER_ID INVOICE_HEADER_ID 
from	(((BI11G_DW.C$_4993650864_2_0 LEFT OUTER JOIN 
( /* Subselect from LKP_W_CUST_LOC_USE_PS_SLD_TO_ID
*/


select 
	  

	   
	   W_CUST_LOC_USE_PS.ACCT_SITE_ID ACCT_SITE_ID,
	W_CUST_LOC_USE_PS.CUST_ACCNT_ID CUST_ACCNT_ID,
	W_CUST_LOC_USE_PS.SITE_USE_ID SITE_USE_ID,
	W_CUST_LOC_USE_PS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	W_CUST_LOC_USE_PS.SRC_EFF_FROM_DT SRC_EFF_FROM_DT,
	W_CUST_LOC_USE_PS.SRC_EFF_TO_DT SRC_EFF_TO_DT,
	W_CUST_LOC_USE_PS.CHANGED_ON_DT CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX3_CHANGED_ON_DT AUX3_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX4_CHANGED_ON_DT AUX4_CHANGED_ON_DT
from	BI11G_DW.W_CUST_LOC_USE_PS   W_CUST_LOC_USE_PS
where	(1=1)

And (W_CUST_LOC_USE_PS.SITE_USE_CODE IN ('SOLD_TO', 'BILL_TO'))







)    LKP_W_CUST_LOC_USE_PS_SLD ON TO_CHAR(C52_SOLD_TO_SITE_USE_ID) =LKP_W_CUST_LOC_USE_PS_SLD.SITE_USE_ID 
AND 	#BIAPPS.DATASOURCE_NUM_ID=LKP_W_CUST_LOC_USE_PS_SLD.DATASOURCE_NUM_ID 
AND 	C35_CREATED_ON_DT >=LKP_W_CUST_LOC_USE_PS_SLD.SRC_EFF_FROM_DT 
AND 	C35_CREATED_ON_DT <LKP_W_CUST_LOC_USE_PS_SLD.SRC_EFF_TO_DT) LEFT OUTER JOIN 
( /* Subselect from LKP_W_CUST_LOC_USE_PS_PYR_TO_ID
*/


select 
	  

	   
	   W_CUST_LOC_USE_PS.ACCT_SITE_ID ACCT_SITE_ID,
	W_CUST_LOC_USE_PS.CUST_ACCNT_ID CUST_ACCNT_ID,
	W_CUST_LOC_USE_PS.SITE_USE_ID SITE_USE_ID,
	W_CUST_LOC_USE_PS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	W_CUST_LOC_USE_PS.SRC_EFF_FROM_DT SRC_EFF_FROM_DT,
	W_CUST_LOC_USE_PS.SRC_EFF_TO_DT SRC_EFF_TO_DT,
	W_CUST_LOC_USE_PS.CHANGED_ON_DT CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX3_CHANGED_ON_DT AUX3_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX4_CHANGED_ON_DT AUX4_CHANGED_ON_DT
from	BI11G_DW.W_CUST_LOC_USE_PS   W_CUST_LOC_USE_PS
where	(1=1)

And (W_CUST_LOC_USE_PS.SITE_USE_CODE IN ('BILL_TO','DRAWEE'))







)    LKP_W_CUST_LOC_USE_PS_PYR ON TO_CHAR(COALESCE(C53_PAYING_SITE_USE_ID,C54_BILL_TO_SITE_USE_ID)) =LKP_W_CUST_LOC_USE_PS_PYR.SITE_USE_ID 
AND  	#BIAPPS.DATASOURCE_NUM_ID =LKP_W_CUST_LOC_USE_PS_PYR.DATASOURCE_NUM_ID
AND	C35_CREATED_ON_DT >=LKP_W_CUST_LOC_USE_PS_PYR.SRC_EFF_FROM_DT
AND	C35_CREATED_ON_DT <LKP_W_CUST_LOC_USE_PS_PYR.SRC_EFF_TO_DT) LEFT OUTER JOIN 
( /* Subselect from LKP_W_CUST_LOC_USE_PS_SHP_TO_ID
*/


select 
	  

	   
	   W_CUST_LOC_USE_PS.ACCT_SITE_ID ACCT_SITE_ID,
	W_CUST_LOC_USE_PS.CUST_ACCNT_ID CUST_ACCNT_ID,
	W_CUST_LOC_USE_PS.TERRITORY_ID TERRITORY_ID,
	W_CUST_LOC_USE_PS.SITE_USE_ID SITE_USE_ID,
	W_CUST_LOC_USE_PS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	W_CUST_LOC_USE_PS.SRC_EFF_FROM_DT SRC_EFF_FROM_DT,
	W_CUST_LOC_USE_PS.SRC_EFF_TO_DT SRC_EFF_TO_DT,
	W_CUST_LOC_USE_PS.CHANGED_ON_DT CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX3_CHANGED_ON_DT AUX3_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX4_CHANGED_ON_DT AUX4_CHANGED_ON_DT
from	BI11G_DW.W_CUST_LOC_USE_PS   W_CUST_LOC_USE_PS
where	(1=1)

And (W_CUST_LOC_USE_PS.SITE_USE_CODE = 'SHIP_TO')







)    LKP_W_CUST_LOC_USE_PS_SHP ON TO_CHAR(C55_SHIP_TO_SITE_USE_ID) =LKP_W_CUST_LOC_USE_PS_SHP.SITE_USE_ID
AND	#BIAPPS.DATASOURCE_NUM_ID =LKP_W_CUST_LOC_USE_PS_SHP.DATASOURCE_NUM_ID
AND	C35_CREATED_ON_DT >=LKP_W_CUST_LOC_USE_PS_SHP.SRC_EFF_FROM_DT
AND	C35_CREATED_ON_DT <LKP_W_CUST_LOC_USE_PS_SHP.SRC_EFF_TO_DT) LEFT OUTER JOIN 
( /* Subselect from LKP_W_CUST_LOC_USE_PS_INVC_TO_ID
*/


select 
	  

	   
	   W_CUST_LOC_USE_PS.ACCT_SITE_ID ACCT_SITE_ID,
	W_CUST_LOC_USE_PS.CUST_ACCNT_ID CUST_ACCNT_ID,
	W_CUST_LOC_USE_PS.SITE_USE_ID SITE_USE_ID,
	W_CUST_LOC_USE_PS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	W_CUST_LOC_USE_PS.SRC_EFF_FROM_DT SRC_EFF_FROM_DT,
	W_CUST_LOC_USE_PS.SRC_EFF_TO_DT SRC_EFF_TO_DT,
	W_CUST_LOC_USE_PS.CHANGED_ON_DT CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX1_CHANGED_ON_DT AUX1_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX2_CHANGED_ON_DT AUX2_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX3_CHANGED_ON_DT AUX3_CHANGED_ON_DT,
	W_CUST_LOC_USE_PS.AUX4_CHANGED_ON_DT AUX4_CHANGED_ON_DT
from	BI11G_DW.W_CUST_LOC_USE_PS   W_CUST_LOC_USE_PS
where	(1=1)

And (W_CUST_LOC_USE_PS.SITE_USE_CODE = 'BILL_TO')







)    LKP_W_CUST_LOC_USE_PS_INVC ON TO_CHAR(C54_BILL_TO_SITE_USE_ID) = LKP_W_CUST_LOC_USE_PS_INVC.SITE_USE_ID
AND	#BIAPPS.DATASOURCE_NUM_ID = LKP_W_CUST_LOC_USE_PS_INVC.DATASOURCE_NUM_ID
AND	C35_CREATED_ON_DT >= LKP_W_CUST_LOC_USE_PS_INVC.SRC_EFF_FROM_DT
AND	C35_CREATED_ON_DT < LKP_W_CUST_LOC_USE_PS_INVC.SRC_EFF_TO_DT
where		(1=1)	






)    ODI_GET_FROM







