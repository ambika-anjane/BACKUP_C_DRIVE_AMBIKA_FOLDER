-- w_employee_d

select * from  ORACLE_MASTER_DATA.PER_JOBS
select * from  ORACLE_MASTER_DATA.PER_ASSIGNMENT_STATUS_TYPES
DESC TABLE ORACLE_MASTER_DATA.PER_ALL_PEOPLE_F
SELECT * FROM ORACLE_FINANCIALS.PER_PERIODS_OF_SERVICE
select * from  ORACLE_MASTER_DATA.PER_ALL_ASSIGNMENTS_F
select * from  ORACLE_MASTER_DATA.PER_ALL_ASSIGNMENTS_F

use database DEV_ODS

select STYLE  from  ORACLE_MASTER_DATA.HR_LOCATIONS_ALL


-- PAYMENT_TERMS_D
select ORACLE_FINANCIALS.RA_TERMS_LINES.TERM_ID from  ORACLE_FINANCIALS.RA_TERMS_LINES
DESC TABLE ORACLE_FINANCIALS.RA_TERMS_LINES

Select	
	
	COALESCE(TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.TERM_ID),'__UNASSIGNED__')	   C1_PAYMENT_TERM_CODE,
	MAX(
	CASE
WHEN ORACLE_FINANCIALS.RA_TERMS_LINES.SEQUENCE_NUM=1 THEN TO_CHAR(COALESCE(ORACLE_FINANCIALS.RA_TERMS_LINES.RELATIVE_AMOUNT,ORACLE_FINANCIALS.RA_TERMS_LINES.BASE_AMOUNT))||(CASE
WHEN ORACLE_FINANCIALS.RA_TERMS_LINES.RELATIVE_AMOUNT IS NULL THEN ''
ELSE '%'
END )||' Due '||(CASE
WHEN 
		ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAYS IS NULL THEN 
		'on day '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAY_OF_MONTH)||' after month '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_MONTHS_FORWARD)
ELSE 
		'in '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAYS)||' days'
	
END 
              FROM ORACLE_FINANCIALS.RA_TERMS_LINES

      
)	   C2_CONDITION_1_TEXT


SELECT INVENTORY_LOCATION_ID
  FROM ORACLE_MASTER_DATA.MTL_SECONDARY_INVENTORIES
desc table ORACLE_MASTER_DATA.MTL_PARAMETERS
select CONCATENATED_SEGMENTS from  ORACLE_MASTER_DATA.MTL_PARAMETERS

  SELECT * fROM ORACLE_INVENTORY.MTL_ITEM_LOCATIONS 
     
      
      mtl_material_transactions
    
  SELECT * FROM "DEV_DISCOVER"."MASTER_DATA"."STG_ORACLE__MTL_ITEM_LOCATIONS"
      DESC TABLE ORACLE_INVENTORY.MTL_ITEM_LOCATIONS 
  desc table ORACLE_MASTER_DATA.HR_LOCATIONS_ALL 
   SELECT * FROM ORACLE_MASTER_DATA.HR_ALL_ORGANIZATION_UNITS
   
SELECT CONCATENATED_SEGMENTS FROM ORACLE_MASTER_DATA.HR_ALL_ORGANIZATION_UNITS
SELECT   'STORAGE_LOC~'||TO_CHAR(ORACLE_MASTER_DATA.MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID) FROM ORACLE_MASTER_DATA.MTL_SECONDARY_INVENTORIES

SELECT * FROM "DEV_EDW"."BI11G_DW"."W_CUSTOMER_LOC_D"
SELECT * FROM "DEV_EDW"."EDW_OMNI"."W_CUSTOMER_LOCATION_D"
    
      
SELECT * FROM "DEV_EDW"."BI11G_DW"."W__LOC_D"
SELECT * FROM "DEV_EDW"."BI11G_DW"."W_BUSN_LOCATION_D"  WHERE LOCATOR_TYPE_CODE
 IS NOT NULL

SELECT MAX(
	CASE
WHEN ORACLE_FINANCIALS.RA_TERMS_LINES.SEQUENCE_NUM=2 THEN TO_CHAR(COALESCE(ORACLE_FINANCIALS.RA_TERMS_LINES.RELATIVE_AMOUNT,ORACLE_FINANCIALS.RA_TERMS_LINES.BASE_AMOUNT))||(CASE
WHEN ORACLE_FINANCIALS.RA_TERMS_LINES.RELATIVE_AMOUNT IS NULL THEN ''
ELSE '%'
END )||' Due '||(CASE
WHEN 
		ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAYS IS NULL THEN 
		'on day '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAY_OF_MONTH)||' after month '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_MONTHS_FORWARD)
ELSE 
		'in '||TO_CHAR(ORACLE_FINANCIALS.RA_TERMS_LINES.DUE_DAYS)||' days'
	
END )
ELSE NULL
END
)	   C3_CONDITION_2_TEXT
      
      
      
      
  
      
      
 
-- unique test
select
    integration_id as unique_field,
    count(*) as n_records
from dev_edw.edw_omni.w_customer_location_d
group by integration_id
having count(*) > 1   
      
SELECT _BATCH_UPDATE_DATE,STATUS,_SOURCE_ID FROM ORACLE_MASTER_DATA.HZ_CUST_ACCT_SITES_ALL WHERE  CUST_ACCT_SITE_ID =10011070
delete from "DEV_EDW"."EDW_OMNI"."W_CUSTOMER_LOCATION_D" WHERE  INTEGRATION_ID ='10011070~100'
update ORACLE_MASTER_DATA.HZ_CUST_ACCT_SITES_ALL set  STATUS = 'A' WHERE CUST_ACCT_SITE_ID = 10011070
update ORACLE_MASTER_DATA.HZ_CUST_ACCT_SITES_ALL set _BATCH_UPDATE_DATE = CURRENT_TIMESTAMP()  WHERE  CUST_ACCT_SITE_ID = 10011070
SELECT ACTIVE_FLAG,INTEGRATION_ID,W_INSERT_DT,W_UPDATE_DT  FROM "DEV_EDW"."EDW_OMNI"."W_CUSTOMER_LOCATION_D" WHERE  INTEGRATION_ID =  '10011070~100'

      

-- unique test
select
    integration_id as unique_field,
    count(*) as n_records
from dev_edw.edw_omni.w_customer_location_d
group by integration_id
having count(*) > 1
      
      
      
   SELECT * FROM "DEV_EDW"."EDW_METADATA"."EL_BATCH_REFRESH_TRACKER" WHERE TABLE_NAME = 'w_customer_location_d'

SELECT * FROM "DEV_EDW"."EDW_METADATA"."EL_AUDIT_BALANCE_LOG" WHERE NODE_NAME
 = 'w_inventory_location_d'
   
      
      
      select * from  ORACLE_MASTER_DATA.HZ_CUST_ACCT_SITES_ALL WHERE CUST_ACCT_SITE_ID = 10011070
select * from ORACLE_MASTER_DATA.HZ_LOCATIONS

     SELECT * FROM "DEV_DISCOVER"."MASTER_DATA"."STG_ORACLE__CUSTOMER_CONTACT_POINTS"
           SELECT * FROM "DEV_DISCOVER"."MASTER_DATA"."STG_ORACLE__PARTY_LOCATIONS"

 