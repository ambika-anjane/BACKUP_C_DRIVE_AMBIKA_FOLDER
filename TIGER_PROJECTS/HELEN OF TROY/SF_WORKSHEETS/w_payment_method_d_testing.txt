USE DATABASE DEV_ODS


UPDATE ORACLE_FINANCIALS.AR_RECEIPT_METHODS  SET NAME ='Bank Fees - BofA Oper'  WHERE RECEIPT_METHOD_ID = '1082'

-- UPDATE WIH THIS VALUE
select END_DATE from ORACLE_FINANCIALS.AR_RECEIPT_METHODS WHERE RECEIPT_METHOD_ID = '1024'
UPDATE ORACLE_FINANCIALS.AR_RECEIPT_METHODS  SET END_DATE = NULL WHERE RECEIPT_METHOD_ID = '1024'
UPDATE ORACLE_FINANCIALS.AR_RECEIPT_METHODS   SET _batch_update_date = CURRENT_TIMESTAMP() WHERE RECEIPT_METHOD_ID = '1024'
SELECT * FROM  "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1024'

-- INCREMANTAL INSERT TEST
SELECT * FROM  "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1024'
delete from "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1024' 
UPDATE ORACLE_FINANCIALS.AR_RECEIPT_METHODS   SET _batch_update_date = CURRENT_TIMESTAMP() WHERE RECEIPT_METHOD_ID = '1024'
SELECT W_INSERT_DT,W_UPDATE_DT,ACTIVE_FLG,INTEGRATION_ID FROM  "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1024'


SELECT W_INSERT_DT,W_UPDATE_DT,PAYMENT_METHOD_CODE,PAYMENT_METHOD_NAME FROM "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1082'
-- INSERT OPERATION INCREMENTAL Cheque - Dresdner EUR
 UPDATE ORACLE_FINANCIALS.AR_RECEIPT_METHODS   SET _batch_update_date = CURRENT_TIMESTAMP() WHERE RECEIPT_METHOD_ID = '1024'
 -- after dbt incremental record 1082 gets inserted into the target from stage
SELECT payment_method_code,payment_method_name FROM  "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D" WHERE PAYMENT_METHOD_CODE  = '1082'

-- refresh tracker
SELECT * FROM "DEV_EDW"."EDW_METADATA"."EL_BATCH_REFRESH_TRACKER" WHERE TABLE_NAME = 'w_payment_method_d'

-- unique test
select
    integration_id as unique_field,
    count(*) as n_records
from dev_edw.edw_omni.w_payment_method_d
group by integration_id
having count(*) > 1


-- audit logs 
select * from "DEV_EDW"."EDW_METADATA"."EL_AUDIT_BALANCE_LOG" where node_name = 'w_payment_method_d'


select * from "DEV_EDW"."EDW_OMNI"."W_PAYMENT_METHOD_D"

SELECT SYSTEM$CANCEL_QUERY( '01aa14fb-0504-438a-000b-ab870855f0be' )


