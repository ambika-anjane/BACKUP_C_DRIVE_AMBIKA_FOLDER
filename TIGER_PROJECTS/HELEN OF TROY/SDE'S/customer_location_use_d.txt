



/* Db link option chosen and SDS not deployed */
create or replace view APPS.C$_4910920864_2_0
(
	C1_CUST_ACCNT_ID,
	C2_CUSTOMER_LOC_ID,
	C3_ACCT_SITE_ID,
	C4_ADDRESS_NUM,
	C5_SITE_USE_ID,
	C6_SITE_USE_CODE,
	C7_TERRITORY_ID,
	C8_ACTIVE_FLG,
	C9_CREATED_BY_ID,
	C10_CHANGED_BY_ID,
	C11_CREATED_ON_DT,
	C12_CHANGED_ON_DT,
	C13_AUX1_CHANGED_ON_DT,
	C14_AUX2_CHANGED_ON_DT,
	C15_AUX3_CHANGED_ON_DT,
	C16_AUX4_CHANGED_ON_DT,
	C17_DELETE_FLG,
	C18_INTEGRATION_ID,
	C19_X_CUSTOM,
	C20_X_COLLECTOR_NAME,
	C21_X_COLLECTOR_DESCRIPTION,
	C22_X_PRIMARY_FLAG,
	C23_X_GL_ID_REV
)
as select	
	
	SQ_CUSTLOC_USE.CUST_ACCOUNT_ID	   C1_CUST_ACCNT_ID,
	TO_CHAR(SQ_CUSTLOC_USE.CUST_ACCT_SITE_ID)	   C2_CUSTOMER_LOC_ID,
	TO_CHAR(SQ_CUSTLOC_USE.CUST_ACCT_SITE_ID)	   C3_ACCT_SITE_ID,
	SQ_CUSTLOC_USE.LOCATION	   C4_ADDRESS_NUM,
	SQ_CUSTLOC_USE.SITE_USE_ID	   C5_SITE_USE_ID,
	SQ_CUSTLOC_USE.SITE_USE_CODE	   C6_SITE_USE_CODE,
	SQ_CUSTLOC_USE.TERRITORY_ID	   C7_TERRITORY_ID,
	CASE 
	WHEN SQ_CUSTLOC_USE.STATUS='I' THEN 'N'
	ELSE 'Y'
END	   C8_ACTIVE_FLG,
	TO_CHAR(SQ_CUSTLOC_USE.CREATED_BY)	   C9_CREATED_BY_ID,
	TO_CHAR(SQ_CUSTLOC_USE.LAST_UPDATED_BY)	   C10_CHANGED_BY_ID,
	SQ_CUSTLOC_USE.CREATION_DATE	   C11_CREATED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE	   C12_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE1	   C13_AUX1_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE2	   C14_AUX2_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE3	   C15_AUX3_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.LAST_UPDATE_DATE4	   C16_AUX4_CHANGED_ON_DT,
	SQ_CUSTLOC_USE.DELETE_FLG	   C17_DELETE_FLG,
	TO_CHAR(SQ_CUSTLOC_USE.SITE_USE_ID)	   C18_INTEGRATION_ID,
	SQ_CUSTLOC_USE.X_CUSTOM	   C19_X_CUSTOM,
	SQ_CUSTLOC_USE.COLLECTOR_NAME	   C20_X_COLLECTOR_NAME,
	SQ_CUSTLOC_USE.COLLECTOR_DESCRIPTION	   C21_X_COLLECTOR_DESCRIPTION,
	SQ_CUSTLOC_USE.PRIMARY_FLAG	   C22_X_PRIMARY_FLAG,
	SQ_CUSTLOC_USE.GL_ID_REV	   C23_X_GL_ID_REV
from	
( /* Subselect from SDE_ORA_CustomerLocationUseStaging.W_CUST_LOC_USE_PS_SQ_CUSTLOC_USE
*/


select 
	  /*+ USE_NL(CA L PS CSU CAS) */

	   
	   CSU.SITE_USE_ID SITE_USE_ID,
	
CSU.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	CSU.LAST_UPDATED_BY LAST_UPDATED_BY,
	CSU.CREATION_DATE CREATION_DATE,
	CSU.CREATED_BY CREATED_BY,
	CA.CUST_ACCOUNT_ID CUST_ACCOUNT_ID,
	CSU.SITE_USE_CODE SITE_USE_CODE,
	L.LOCATION_ID LOCATION_ID,
	CSU.CUST_ACCT_SITE_ID CUST_ACCT_SITE_ID,
	PS.PARTY_SITE_ID PARTY_SITE_ID,
	CAS.LAST_UPDATE_DATE LAST_UPDATE_DATE1,
	CSU.STATUS STATUS,
	CSU.TERRITORY_ID TERRITORY_ID,
	PS.LAST_UPDATE_DATE LAST_UPDATE_DATE2,
	L.LAST_UPDATE_DATE LAST_UPDATE_DATE3,
	CA.LAST_UPDATE_DATE LAST_UPDATE_DATE4,
	'0' X_CUSTOM,
	
'N'
 DELETE_FLG,
	CSU.LOCATION LOCATION,
	AR_COLLECTORS.NAME COLLECTOR_NAME,
	AR_COLLECTORS.DESCRIPTION COLLECTOR_DESCRIPTION,
	CSU.PRIMARY_FLAG PRIMARY_FLAG,
	CSU.GL_ID_REV GL_ID_REV
from	APPS.AR_COLLECTORS    AR_COLLECTORS RIGHT OUTER JOIN (APPS.HZ_CUSTOMER_PROFILES    HZ_CUSTOMER_PROFILES RIGHT OUTER JOIN (APPS.HZ_CUST_ACCOUNTS    CA INNER JOIN (APPS.HZ_LOCATIONS    L INNER JOIN (APPS.HZ_PARTY_SITES    PS INNER JOIN (APPS.HZ_CUST_SITE_USES_ALL    CSU INNER JOIN APPS.HZ_CUST_ACCT_SITES_ALL    CAS ON CSU.CUST_ACCT_SITE_ID=CAS.CUST_ACCT_SITE_ID) ON PS.PARTY_SITE_ID=CAS.PARTY_SITE_ID) ON L.LOCATION_ID=PS.LOCATION_ID) ON CA.CUST_ACCOUNT_ID=CAS.CUST_ACCOUNT_ID) ON HZ_CUSTOMER_PROFILES.SITE_USE_ID=CSU.SITE_USE_ID) ON AR_COLLECTORS.COLLECTOR_ID=HZ_CUSTOMER_PROFILES.COLLECTOR_ID
where	(1=1)

And (


((EXISTS (SELECT 1 FROM
(SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     APPS.HZ_CUST_ACCT_SITES_ALL

      WHERE HZ_CUST_ACCT_SITES_ALL.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
      UNION
	  SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     APPS.HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
     APPS.HZ_CUST_ACCOUNTS

      ON HZ_CUST_ACCT_SITES_ALL.CUST_ACCOUNT_ID=HZ_CUST_ACCOUNTS.CUST_ACCOUNT_ID
      WHERE HZ_CUST_ACCOUNTS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  UNION
	  SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     APPS.HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
     APPS.HZ_CUST_SITE_USES_ALL

      ON HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID=HZ_CUST_SITE_USES_ALL.CUST_ACCT_SITE_ID
      WHERE HZ_CUST_SITE_USES_ALL.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  UNION
      SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM 
     APPS.HZ_CUST_ACCT_SITES_ALL
 INNER JOIN
        
     APPS.HZ_PARTY_SITES

      ON HZ_CUST_ACCT_SITES_ALL.PARTY_SITE_ID=HZ_PARTY_SITES.PARTY_SITE_ID
      WHERE HZ_PARTY_SITES.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
      UNION
      SELECT HZ_CUST_ACCT_SITES_ALL.CUST_ACCT_SITE_ID
      FROM (
     APPS.HZ_CUST_ACCT_SITES_ALL

  INNER JOIN (
     APPS.HZ_PARTY_SITES
 INNER JOIN 
     APPS.HZ_LOCATIONS

  ON HZ_PARTY_SITES.LOCATION_ID          =HZ_LOCATIONS.LOCATION_ID)
  ON HZ_CUST_ACCT_SITES_ALL.PARTY_SITE_ID=HZ_PARTY_SITES.PARTY_SITE_ID)
      WHERE HZ_LOCATIONS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') 
	  UNION
	  SELECT   CAS.CUST_ACCT_SITE_ID FROM 
APPS.HZ_CUST_SITE_USES_ALL CSU,APPS.HZ_CUST_ACCT_SITES_ALL    CAS,APPS.HZ_CUSTOMER_PROFILES    HZ_CUSTOMER_PROFILES ,
APPS.AR_COLLECTORS    AR_COLLECTORS
WHERE CSU.CUST_ACCT_SITE_ID=CAS.CUST_ACCT_SITE_ID 
AND HZ_CUSTOMER_PROFILES.SITE_USE_ID(+)=CSU.SITE_USE_ID
AND AR_COLLECTORS.COLLECTOR_ID(+)=HZ_CUSTOMER_PROFILES.COLLECTOR_ID
AND 
(AR_COLLECTORS.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') OR 
HZ_CUSTOMER_PROFILES.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') OR
CSU.LAST_UPDATE_DATE > TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))
	  ) TEMP 
WHERE  CAS.CUST_ACCT_SITE_ID=TEMP.CUST_ACCT_SITE_ID )))


)







)   SQ_CUSTLOC_USE
where	(1=1)








