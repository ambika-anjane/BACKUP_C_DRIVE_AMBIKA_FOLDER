

select	
	
	SQ_STORAGELOCATION.STYLE	   C1_ADDRESS_TYPE_CODE,
	SQ_STORAGELOCATION.CONCATENATED_SEGMENTS	   C2_BUSN_LOC_NUM,
	SQ_STORAGELOCATION.SUBINVENTORY_CODE	   --C3_PARENT_LOC_NUM,
	TO_CHAR(SQ_STORAGELOCATION.ORGANIZATION_ID)||_source_id	   C4_ORGANIZATION_ID,
	SQ_STORAGELOCATION.ORGANIZATION_CODE	   C5_ORGANIZATION_CODE,
	--'STORAGE_LOC~'||TO_CHAR(SQ_STORAGELOCATION.ORGANIZATION_ID)||'~~'	   C6_ORG_LVL_INT_ID,
	COALESCE(TO_CHAR(SQ_STORAGELOCATION.SUBINVENTORY_TYPE),'__UNASSIGNED__')	   C7_SUBINVENTORY_TYPE_CODE,
	--'STORAGE_LOC~'||TO_CHAR(SQ_STORAGELOCATION.ORGANIZATION_ID)||'~'||SQ_STORAGELOCATION.SUBINVENTORY_CODE||'~'	   C8_SUBINV_LVL_INT_ID,
	TO_CHAR(SQ_STORAGELOCATION.INVENTORY_LOCATION_ID)	   C9_LOCATOR_ID,
	COALESCE(TO_CHAR(SQ_STORAGELOCATION.INVENTORY_LOCATION_TYPE),'__UNASSIGNED__')	   C10_LOCATOR_TYPE_CODE,
	--'STORAGE_LOC~'||TO_CHAR(SQ_STORAGELOCATION.ORGANIZATION_ID)||'~'||SQ_STORAGELOCATION.SUBINVENTORY_CODE||'~'||TO_CHAR(SQ_STORAGELOCATION.INVENTORY_LOCATION_ID)	   C11_LOCATOR_LVL_INT_ID,
	CASE WHEN SQ_STORAGELOCATION.DISABLE_DATE IS NULL THEN 'Y'
ELSE 'N'
END	   C12_ACTIVE_FLG,
	TO_CHAR(SQ_STORAGELOCATION.CREATED_BY)	   C13_CREATED_BY_ID,
	CASE WHEN SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE IS NULL OR SQ_STORAGELOCATION.ITEM_LAST_UPDATE_DATE>SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE THEN TO_CHAR(SQ_STORAGELOCATION.ITEM_LAST_UPDATED_BY)
ELSE TO_CHAR(SQ_STORAGELOCATION.LOC_LAST_UPDATED_BY)
END	   C14_CHANGED_BY_ID,
	SQ_STORAGELOCATION.CREATION_DATE	   C15_CREATED_ON_DT,
	CASE WHEN SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE IS NULL OR SQ_STORAGELOCATION.ITEM_LAST_UPDATE_DATE>SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE THEN SQ_STORAGELOCATION.ITEM_LAST_UPDATE_DATE
ELSE SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE
END	   C16_CHANGED_ON_DT,
	SQ_STORAGELOCATION.LOC_LAST_UPDATE_DATE	   C17_AUX1_CHANGED_ON_DT,
	SQ_STORAGELOCATION.INV_LAST_UPDATE_DATE	   C18_AUX2_CHANGED_ON_DT,
	SQ_STORAGELOCATION.DELETE_FLG	   C19_DELETE_FLG,
	TO_CHAR(SQ_STORAGELOCATION.ORGANIZATION_ID)||'~'||SQ_STORAGELOCATION.SUBINVENTORY_CODE||'~'||TO_CHAR(SQ_STORAGELOCATION.INVENTORY_LOCATION_ID)||_source_id	   C20_INTEGRATION_ID,
	SQ_STORAGELOCATION.TELEPHONE_NUMBER_1	   C21_TELEPHONE_NUMBER_1,
	SQ_STORAGELOCATION.TELEPHONE_NUMBER_2	   C22_TELEPHONE_NUMBER_2,
	SQ_STORAGELOCATION.TELEPHONE_NUMBER_3	   C23_TELEPHONE_NUMBER_3,
	SQ_STORAGELOCATION.REGION_1	   C24_REGION_1,
	SQ_STORAGELOCATION.REGION_2	   C25_REGION_2,
	SQ_STORAGELOCATION.REGION_3	   C26_REGION_3,
	SQ_STORAGELOCATION.ADDRESS_LINE_1	   C27_ADDRESS_LINE_1,
	SQ_STORAGELOCATION.ADDRESS_LINE_2	   C28_ADDRESS_LINE_2,
	SQ_STORAGELOCATION.ADDRESS_LINE_3	   C29_ADDRESS_LINE_3,
	SQ_STORAGELOCATION.TOWN_OR_CITY	   C30_TOWN_OR_CITY,
	SQ_STORAGELOCATION.POSTAL_CODE	   C31_POSTAL_CODE,
	SQ_STORAGELOCATION.COUNTRY	   C32_COUNTRY
from	
( /* Subselect from SDE_ORA_BusinessLocationDimension_StorageLocation.W_BUSN_LOCATION_DS_SQ_EXTRACT
*/


select 
	  

	   
	   MTL_ITEM_LOCATIONS.SEGMENT1 || '.' || MTL_ITEM_LOCATIONS.SEGMENT2 || '.' || MTL_ITEM_LOCATIONS.SEGMENT3 || '.' || MTL_ITEM_LOCATIONS.SEGMENT4 || '.' ||MTL_ITEM_LOCATIONS.SEGMENT5 CONCATENATED_SEGMENTS,
	MTL_ITEM_LOCATIONS.DESCRIPTION DESCRIPTION,
	MTL_ITEM_LOCATIONS.SUBINVENTORY_CODE SUBINVENTORY_CODE,
	MTL_ITEM_LOCATIONS.INVENTORY_LOCATION_ID INVENTORY_LOCATION_ID,
	MTL_ITEM_LOCATIONS.CREATION_DATE CREATION_DATE,
	MTL_ITEM_LOCATIONS.CREATED_BY CREATED_BY,
	

MTL_ITEM_LOCATIONS.LAST_UPDATE_DATE
 ITEM_LAST_UPDATE_DATE,
	MTL_ITEM_LOCATIONS.LAST_UPDATED_BY ITEM_LAST_UPDATED_BY,
	MTL_PARAMETERS.ORGANIZATION_CODE ORGANIZATION_CODE,
	NVL(INVENTORY_LOC.LOCATION_ID,PLANT_LOC.LOCATION_ID) LOCATION_ID,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_1
ELSE INVENTORY_LOC.ADDRESS_LINE_1
END ADDRESS_LINE_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_2
ELSE INVENTORY_LOC.ADDRESS_LINE_2
END ADDRESS_LINE_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_3
ELSE INVENTORY_LOC.ADDRESS_LINE_3
END ADDRESS_LINE_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TOWN_OR_CITY
ELSE INVENTORY_LOC.TOWN_OR_CITY
END TOWN_OR_CITY,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.COUNTRY
ELSE INVENTORY_LOC.COUNTRY
END COUNTRY,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.POSTAL_CODE
ELSE INVENTORY_LOC.POSTAL_CODE
END POSTAL_CODE,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_1
ELSE INVENTORY_LOC.REGION_1
END REGION_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_2
ELSE INVENTORY_LOC.REGION_2
END REGION_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_3
ELSE INVENTORY_LOC.REGION_3
END REGION_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_1
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_1
END TELEPHONE_NUMBER_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_2
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_2
END TELEPHONE_NUMBER_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_3
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_3
END TELEPHONE_NUMBER_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.STYLE
ELSE INVENTORY_LOC.STYLE
END STYLE,
	

  CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.LAST_UPDATE_DATE 
ELSE INVENTORY_LOC.LAST_UPDATE_DATE
END
 LOC_LAST_UPDATE_DATE,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.LAST_UPDATED_BY 
ELSE INVENTORY_LOC.LAST_UPDATED_BY
END LOC_LAST_UPDATED_BY,
	MTL_SECONDARY_INVENTORIES.LAST_UPDATE_DATE INV_LAST_UPDATE_DATE,
	MTL_ITEM_LOCATIONS.INVENTORY_LOCATION_TYPE INVENTORY_LOCATION_TYPE,
	MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID ORGANIZATION_ID,
	MTL_SECONDARY_INVENTORIES.SUBINVENTORY_TYPE SUBINVENTORY_TYPE,
	MTL_ITEM_LOCATIONS.DISABLE_DATE DISABLE_DATE,
	

'N'
 DELETE_FLG
from	((((APPS.MTL_ITEM_LOCATIONS    MTL_ITEM_LOCATIONS INNER JOIN APPS.MTL_SECONDARY_INVENTORIES    MTL_SECONDARY_INVENTORIES ON MTL_ITEM_LOCATIONS.ORGANIZATION_ID=MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID
AND
MTL_ITEM_LOCATIONS.SUBINVENTORY_CODE=MTL_SECONDARY_INVENTORIES.SECONDARY_INVENTORY_NAME) INNER JOIN APPS.HR_ALL_ORGANIZATION_UNITS    HR_ALL_ORGANIZATION_UNITS ON MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID=HR_ALL_ORGANIZATION_UNITS.ORGANIZATION_ID) INNER JOIN APPS.MTL_PARAMETERS    MTL_PARAMETERS ON HR_ALL_ORGANIZATION_UNITS.ORGANIZATION_ID=MTL_PARAMETERS.ORGANIZATION_ID) LEFT OUTER JOIN APPS.HR_LOCATIONS_ALL    INVENTORY_LOC ON MTL_SECONDARY_INVENTORIES.LOCATION_ID=INVENTORY_LOC.LOCATION_ID) LEFT OUTER JOIN APPS.HR_LOCATIONS_ALL    PLANT_LOC ON HR_ALL_ORGANIZATION_UNITS.LOCATION_ID=PLANT_LOC.LOCATION_ID
where	(1=1)

And (
 
	

(MTL_ITEM_LOCATIONS.LAST_UPDATE_DATE>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')
OR
MTL_SECONDARY_INVENTORIES.LAST_UPDATE_DATE>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')
OR
INVENTORY_LOC.LAST_UPDATE_DATE>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')
OR
PLANT_LOC.LAST_UPDATE_DATE>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))


)







)   SQ_STORAGELOCATION
where	(1=1)






 

