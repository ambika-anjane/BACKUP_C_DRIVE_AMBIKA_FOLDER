

select	
	
	SQ_INVENTORY.STYLE	   C1_ADDRESS_TYPE_CODE,
	SQ_INVENTORY.SUBINVENTORY_CODE	   C2_BUSN_LOC_NUM,
	SQ_INVENTORY.SUBINVENTORY_CODE	   C3_PARENT_LOC_NUM,
	TO_CHAR(SQ_INVENTORY.ORGANIZATION_ID)	   C4_ORGANIZATION_ID,
	SQ_INVENTORY.ORGANIZATION_CODE	   C5_ORGANIZATION_CODE,
	'STORAGE_LOC~'||TO_CHAR(SQ_INVENTORY.ORGANIZATION_ID)||'~~'	   C6_ORG_LVL_INT_ID,
	COALESCE(TO_CHAR(SQ_INVENTORY.SUBINVENTORY_TYPE),'__UNASSIGNED__')	   C7_SUBINVENTORY_TYPE_CODE,
	'STORAGE_LOC~'||TO_CHAR(SQ_INVENTORY.ORGANIZATION_ID)||'~'||SQ_INVENTORY.SUBINVENTORY_CODE||'~'	   C8_SUBINV_LVL_INT_ID,
	null	   C9_LOCATOR_ID,
	null	   C10_LOCATOR_TYPE_CODE,
	CASE WHEN SQ_INVENTORY.DISABLE_DATE IS NULL THEN 'Y'
ELSE 'N'
END	   C11_ACTIVE_FLG,
	TO_CHAR(SQ_INVENTORY.CREATED_BY)	   C12_CREATED_BY_ID,
	CASE WHEN SQ_INVENTORY.LOC_LAST_UPDATE_DATE IS NULL OR SQ_INVENTORY.INV_LAST_UPDATE_DATE>SQ_INVENTORY.LOC_LAST_UPDATE_DATE THEN TO_CHAR(SQ_INVENTORY.INV_LAST_UPDATED_BY)
ELSE TO_CHAR(SQ_INVENTORY.LOC_LAST_UPDATED_BY)
END	   C13_CHANGED_BY_ID,
	SQ_INVENTORY.CREATION_DATE	   C14_CREATED_ON_DT,
	CASE WHEN SQ_INVENTORY.LOC_LAST_UPDATE_DATE IS NULL OR SQ_INVENTORY.INV_LAST_UPDATE_DATE>SQ_INVENTORY.LOC_LAST_UPDATE_DATE THEN SQ_INVENTORY.INV_LAST_UPDATE_DATE
ELSE SQ_INVENTORY.LOC_LAST_UPDATE_DATE
END	   C15_CHANGED_ON_DT,
	SQ_INVENTORY.LOC_LAST_UPDATE_DATE	   C16_AUX1_CHANGED_ON_DT,
	SQ_INVENTORY.DELETE_FLG	   C17_DELETE_FLG,
	'STORAGE_LOC~'||TO_CHAR(SQ_INVENTORY.ORGANIZATION_ID)||'~'||SQ_INVENTORY.SUBINVENTORY_CODE||'~'	   C18_INTEGRATION_ID,
	SQ_INVENTORY.TELEPHONE_NUMBER_1	   C19_TELEPHONE_NUMBER_1,
	SQ_INVENTORY.TELEPHONE_NUMBER_2	   C20_TELEPHONE_NUMBER_2,
	SQ_INVENTORY.TELEPHONE_NUMBER_3	   C21_TELEPHONE_NUMBER_3,
	SQ_INVENTORY.REGION_1	   C22_REGION_1,
	SQ_INVENTORY.REGION_2	   C23_REGION_2,
	SQ_INVENTORY.REGION_3	   C24_REGION_3,
	SQ_INVENTORY.ADDRESS_LINE_1	   C25_ADDRESS_LINE_1,
	SQ_INVENTORY.ADDRESS_LINE_2	   C26_ADDRESS_LINE_2,
	SQ_INVENTORY.ADDRESS_LINE_3	   C27_ADDRESS_LINE_3,
	SQ_INVENTORY.TOWN_OR_CITY	   C28_TOWN_OR_CITY,
	SQ_INVENTORY.POSTAL_CODE	   C29_POSTAL_CODE,
	SQ_INVENTORY.COUNTRY	   C30_COUNTRY,
	SQ_INVENTORY.ORGANIZATION_ID	   C31_ORGANIZATION_ID
from	
( /* Subselect from SDE_ORA_BusinessLocationDimension_Inventory.W_BUSN_LOCATION_DS_SQ_EXTRACT
*/


select 
	  

	   
	   MTL_SECONDARY_INVENTORIES.SECONDARY_INVENTORY_NAME SUBINVENTORY_CODE,
	MTL_SECONDARY_INVENTORIES.CREATION_DATE CREATION_DATE,
	MTL_SECONDARY_INVENTORIES.CREATED_BY CREATED_BY,
	MTL_PARAMETERS.ORGANIZATION_CODE ORGANIZATION_CODE,
	NVL(INVENTORY_LOC.LOCATION_ID,PLANT_LOC.LOCATION_ID) LOCATION_ID,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_1
ELSE INVENTORY_LOC.ADDRESS_LINE_1
END ADDRESS_LINE_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_2
ELSE INVENTORY_LOC.ADDRESS_LINE_2
END ADDRESS_LINE_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.ADDRESS_LINE_3
ELSE INVENTORY_LOC.ADDRESS_LINE_3
END ADDRESS_LINE_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TOWN_OR_CITY
ELSE INVENTORY_LOC.TOWN_OR_CITY
END TOWN_OR_CITY,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.COUNTRY
ELSE INVENTORY_LOC.COUNTRY
END COUNTRY,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.POSTAL_CODE
ELSE INVENTORY_LOC.POSTAL_CODE
END POSTAL_CODE,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_1
ELSE INVENTORY_LOC.REGION_1
END REGION_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_2
ELSE INVENTORY_LOC.REGION_2
END REGION_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.REGION_3
ELSE INVENTORY_LOC.REGION_3
END REGION_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_1
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_1
END TELEPHONE_NUMBER_1,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_2
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_2
END TELEPHONE_NUMBER_2,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.TELEPHONE_NUMBER_3
ELSE INVENTORY_LOC.TELEPHONE_NUMBER_3
END TELEPHONE_NUMBER_3,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.STYLE
ELSE INVENTORY_LOC.STYLE
END STYLE,
	

  (CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.LAST_UPDATE_DATE  ELSE INVENTORY_LOC.LAST_UPDATE_DATE END)
 LOC_LAST_UPDATE_DATE,
	CASE WHEN INVENTORY_LOC.LOCATION_ID IS NULL THEN PLANT_LOC.LAST_UPDATED_BY 
ELSE INVENTORY_LOC.LAST_UPDATED_BY
END LOC_LAST_UPDATED_BY,
	

  MTL_SECONDARY_INVENTORIES.LAST_UPDATE_DATE
 INV_LAST_UPDATE_DATE,
	MTL_SECONDARY_INVENTORIES.LAST_UPDATED_BY INV_LAST_UPDATED_BY,
	MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID ORGANIZATION_ID,
	MTL_SECONDARY_INVENTORIES.SUBINVENTORY_TYPE SUBINVENTORY_TYPE,
	MTL_SECONDARY_INVENTORIES.DISABLE_DATE DISABLE_DATE,
	

'N'
 DELETE_FLG,
	null CONCATENATED_SEGMENTS,
	null DESCRIPTION,
	null INVENTORY_LOCATION_ID,
	null ITEM_LAST_UPDATE_DATE,
	null ITEM_LAST_UPDATED_BY,
	null INVENTORY_LOCATION_TYPE
from	(((APPS.MTL_SECONDARY_INVENTORIES    MTL_SECONDARY_INVENTORIES INNER JOIN APPS.HR_ALL_ORGANIZATION_UNITS    HR_ALL_ORGANIZATION_UNITS ON MTL_SECONDARY_INVENTORIES.ORGANIZATION_ID=HR_ALL_ORGANIZATION_UNITS.ORGANIZATION_ID) LEFT OUTER JOIN APPS.HR_LOCATIONS_ALL    INVENTORY_LOC ON MTL_SECONDARY_INVENTORIES.LOCATION_ID=INVENTORY_LOC.LOCATION_ID) INNER JOIN APPS.MTL_PARAMETERS    MTL_PARAMETERS ON HR_ALL_ORGANIZATION_UNITS.ORGANIZATION_ID=MTL_PARAMETERS.ORGANIZATION_ID) LEFT OUTER JOIN APPS.HR_LOCATIONS_ALL    PLANT_LOC ON HR_ALL_ORGANIZATION_UNITS.LOCATION_ID=PLANT_LOC.LOCATION_ID
where	(1=1)

And (

  

    (MTL_SECONDARY_INVENTORIES.LAST_UPDATE_DATE>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') OR
     NVL(INVENTORY_LOC.LAST_UPDATE_DATE,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') )>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS') OR
     NVL(PLANT_LOC.LAST_UPDATE_DATE,TO_DATE(SUBSTR('#BIAPPS.LOW_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))>TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS'))


)







)   SQ_INVENTORY
where	(1=1)






 

