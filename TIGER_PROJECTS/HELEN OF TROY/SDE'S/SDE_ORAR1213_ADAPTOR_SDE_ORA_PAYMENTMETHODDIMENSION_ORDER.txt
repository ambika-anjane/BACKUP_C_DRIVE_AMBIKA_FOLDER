



/* Db link option chosen and SDS not deployed */
create or replace view APPS.C$_4870269864_2_0
(
	C1_PAYMENT_METHOD_CODE,
	C2_ACTIVE_FLG,
	C3_CREATED_BY_ID,
	C4_CHANGED_BY_ID,
	C5_CREATED_ON_DT,
	C6_CHANGED_ON_DT,
	C7_DELETE_FLG,
	C8_INTEGRATION_ID,
	C9_LOOKUP_CODE
)
as select	
	
	COALESCE(SQ_FND_LOOKUP_VALUES.LOOKUP_CODE,'__UNASSIGNED__')	   C1_PAYMENT_METHOD_CODE,
	COALESCE(SQ_FND_LOOKUP_VALUES.ENABLED_FLAG,'Y')	   C2_ACTIVE_FLG,
	TO_CHAR(SQ_FND_LOOKUP_VALUES.CREATED_BY)	   C3_CREATED_BY_ID,
	TO_CHAR(SQ_FND_LOOKUP_VALUES.LAST_UPDATED_BY)	   C4_CHANGED_BY_ID,
	SQ_FND_LOOKUP_VALUES.CREATION_DATE	   C5_CREATED_ON_DT,
	SQ_FND_LOOKUP_VALUES.LAST_UPDATE_DATE	   C6_CHANGED_ON_DT,
	SQ_FND_LOOKUP_VALUES.DELETE_FLG	   C7_DELETE_FLG,
	'OM~'||SQ_FND_LOOKUP_VALUES.LOOKUP_CODE 	   C8_INTEGRATION_ID,
	SQ_FND_LOOKUP_VALUES.LOOKUP_CODE	   C9_LOOKUP_CODE
from	
( /* Subselect from SDE_ORA_PaymentMethodDimension_Order.W_PAYMENT_METHOD_DS_SQ_FND_LOOKUP_VALUES
*/


select 
	  

	   
	   FND_LOOKUP_VALUES.LOOKUP_CODE LOOKUP_CODE,
	FND_LOOKUP_VALUES.ENABLED_FLAG ENABLED_FLAG,
	FND_LOOKUP_VALUES.CREATED_BY CREATED_BY,
	FND_LOOKUP_VALUES.CREATION_DATE CREATION_DATE,
	FND_LOOKUP_VALUES.LAST_UPDATED_BY LAST_UPDATED_BY,
	
FND_LOOKUP_VALUES.LAST_UPDATE_DATE
 LAST_UPDATE_DATE,
	
'N'
 DELETE_FLG
from	APPS.FND_LOOKUP_VALUES   FND_LOOKUP_VALUES
where	(1=1)

And (



    FND_LOOKUP_VALUES.LAST_UPDATE_DATE >= TO_DATE(SUBSTR('#BIAPPS.LAST_EXTRACT_DATE',0,19),'YYYY-MM-DD HH24:MI:SS')


)
 And (FND_LOOKUP_VALUES.LOOKUP_TYPE='PAYMENT TYPE')
 And (FND_LOOKUP_VALUES.VIEW_APPLICATION_ID=660)
 And (FND_LOOKUP_VALUES.SECURITY_GROUP_ID=0)
 And (FND_LOOKUP_VALUES.LANGUAGE='#BIAPPS.LANGUAGE_BASE')







)   SQ_FND_LOOKUP_VALUES
where	(1=1)






/***********************************************************************/

insert #BIAPPS.ETL_HINT_INSERT_VALUES into BI11G_DW.C$_4870269864_2_0
(
	C1_PAYMENT_METHOD_CODE,
	C2_ACTIVE_FLG,
	C3_CREATED_BY_ID,
	C4_CHANGED_BY_ID,
	C5_CREATED_ON_DT,
	C6_CHANGED_ON_DT,
	C7_DELETE_FLG,
	C8_INTEGRATION_ID,
	C9_LOOKUP_CODE
)
values
(
	:C1_PAYMENT_METHOD_CODE,
	:C2_ACTIVE_FLG,
	:C3_CREATED_BY_ID,
	:C4_CHANGED_BY_ID,
	:C5_CREATED_ON_DT,
	:C6_CHANGED_ON_DT,
	:C7_DELETE_FLG,
	:C8_INTEGRATION_ID,
	:C9_LOOKUP_CODE
)
/*****************************************/

  
insert  into	BI11G_DW.W_PAYMENT_METHOD_DS 
( 
	W_PAYMENT_METHOD_CODE,
	PAYMENT_METHOD_CODE,
	ACTIVE_FLG,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	DELETE_FLG,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID 
	,PAYMETHOD_CAT_CODE,
	TENANT_ID,
	X_CUSTOM 
) 

select	
	W_PAYMENT_METHOD_CODE,
	PAYMENT_METHOD_CODE,
	ACTIVE_FLG,
	CREATED_BY_ID,
	CHANGED_BY_ID,
	CREATED_ON_DT,
	CHANGED_ON_DT,
	DELETE_FLG,
	DATASOURCE_NUM_ID,
	INTEGRATION_ID
	,'OM',
	'#BIAPPS.TENANT_ID',
	'0'
FROM (	


select 	
	
	COALESCE(
(
SELECT	W_DOMAIN_MEMBER_MAP_G.TRG_DOMAIN_MEMBER_CODE
FROM	BI11G_DW.W_DOMAIN_MEMBER_MAP_G
WHERE	W_DOMAIN_MEMBER_MAP_G.SRC_DOMAIN_CODE = 'SALES_PAYMENT_METHOD'
AND	W_DOMAIN_MEMBER_MAP_G.SRC_DOMAIN_MEMBER_CODE = COALESCE(
C9_LOOKUP_CODE, '__UNASSIGNED__')
AND	W_DOMAIN_MEMBER_MAP_G.SRC_DATASOURCE_NUM_ID IN (
#BIAPPS.DATASOURCE_NUM_ID,999)
AND	W_DOMAIN_MEMBER_MAP_G.TRG_DOMAIN_CODE = 'W_SALES_PAYMENT_METHOD'
),

(
SELECT	W_DOMAIN_MEMBER_MAP_G.TRG_DOMAIN_MEMBER_CODE
FROM	BI11G_DW.W_DOMAIN_MEMBER_MAP_G
WHERE	W_DOMAIN_MEMBER_MAP_G.SRC_DOMAIN_CODE = 'SALES_PAYMENT_METHOD'
AND	W_DOMAIN_MEMBER_MAP_G.SRC_DOMAIN_MEMBER_CODE = '__ANY__'
AND	W_DOMAIN_MEMBER_MAP_G.SRC_DATASOURCE_NUM_ID IN (
#BIAPPS.DATASOURCE_NUM_ID,999)
AND	W_DOMAIN_MEMBER_MAP_G.TRG_DOMAIN_CODE = 'W_SALES_PAYMENT_METHOD'
),

(CASE
WHEN 
C9_LOOKUP_CODE IS NULL THEN COALESCE((
SELECT	W_DOMAIN_MEMBER_G.DOMAIN_MEMBER_CODE
FROM	BI11G_DW.W_DOMAIN_MEMBER_G
WHERE	W_DOMAIN_MEMBER_G.DOMAIN_MEMBER_CODE = '__UNASSIGNED__'
AND	DOMAIN_CODE = 'W_SALES_PAYMENT_METHOD'
),'__ERROR__')
ELSE 

(CASE
WHEN 'W_SALES_PAYMENT_METHOD'='W_LANGUAGE' THEN  '_ERR'
ELSE  '__ERROR__'
END )

END )
)  W_PAYMENT_METHOD_CODE,
	C1_PAYMENT_METHOD_CODE PAYMENT_METHOD_CODE,
	C2_ACTIVE_FLG ACTIVE_FLG,
	C3_CREATED_BY_ID CREATED_BY_ID,
	C4_CHANGED_BY_ID CHANGED_BY_ID,
	C5_CREATED_ON_DT CREATED_ON_DT,
	C6_CHANGED_ON_DT CHANGED_ON_DT,
	C7_DELETE_FLG DELETE_FLG,
	#BIAPPS.DATASOURCE_NUM_ID DATASOURCE_NUM_ID,
	C8_INTEGRATION_ID INTEGRATION_ID 
from	BI11G_DW.C$_4870269864_2_0
where		(1=1)	






)    ODI_GET_FROM

