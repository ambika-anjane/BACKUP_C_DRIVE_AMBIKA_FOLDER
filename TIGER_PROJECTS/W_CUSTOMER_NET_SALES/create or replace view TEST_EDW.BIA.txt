create or replace view TEST_EDW.BIAPPS.W_MCAL_DAY_D(
	ROW_WID,
	MCAL_CAL_WID,
	MCAL_CAL_ID,
	MCAL_CAL_NAME,
	MCAL_CAL_CLASS,
	MCAL_DAY_CODE,
	MCAL_DAY_DT,
	MCAL_DAY_DT_WID,
	ADJUSTMENT_PERIOD_FLG,
	MCAL_PERIOD_WID,
	MCAL_PERIOD_TYPE,
	MCAL_PERIOD_NAME,
	MCAL_PERIOD,
	MCAL_PERIOD_START_DT,
	MCAL_PERIOD_START_DT_WID,
	MCAL_PERIOD_END_DT,
	MCAL_PERIOD_END_DT_WID,
	MCAL_PRIOR_PERIOD_WID,
	MCAL_PERIOD_AGO_WID,
	MCAL_PERIOD_OF_YEAR,
	MCAL_PERIOD_OF_QTR,
	MCAL_PERIOD_NAME_WEEK,
	MCAL_PERIOD_START_DAY_WID,
	MCAL_PERIOD_END_DAY_WID,
	MCAL_JULIAN_PERIOD_NUM,
	MCAL_WEEK_START_DT,
	MCAL_WEEK_START_DT_KEY,
	MCAL_WEEK_START_DT_WID,
	MCAL_WEEK_END_DT,
	MCAL_WEEK_END_DT_KEY,
	MCAL_WEEK_END_DT_WID,
	MCAL_PRIOR_WEEK_WID,
	MCAL_WEEK_AGO_WID,
	MCAL_WEEK_OF_YEAR,
	MCAL_WEEK_OF_QTR,
	MCAL_WEEK_OF_PERIOD,
	MCAL_WEEK_START_DAY_WID,
	MCAL_WEEK_END_DAY_WID,
	MCAL_PER_NAME_HALF,
	MCAL_PER_NAME_TER,
	MCAL_QTR_WID,
	MCAL_QTR,
	MCAL_PER_NAME_QTR,
	MCAL_QTR_START_DT,
	MCAL_QTR_START_DT_WID,
	MCAL_QTR_END_DT,
	MCAL_QTR_END_DT_WID,
	MCAL_PRIOR_QTR_WID,
	MCAL_QTR_AGO_WID,
	MCAL_QTR_OF_YEAR,
	MCAL_QTR_START_DAY_WID,
	MCAL_QTR_END_DAY_WID,
	MCAL_YEAR_WID,
	MCAL_YEAR,
	MCAL_PER_NAME_YEAR,
	MCAL_YEAR_START_DT,
	MCAL_YEAR_START_DT_WID,
	MCAL_YEAR_END_DT,
	MCAL_YEAR_START_PERIOD_WID,
	MCAL_YEAR_END_DT_WID,
	MCAL_YEAR_TOTAL_WEEKS,
	MCAL_YEAR_TOTAL_DAYS,
	MCAL_PRIOR_YEAR_WID,
	MCAL_YEAR_START_DAY_WID,
	MCAL_YEAR_END_DAY_WID,
	MCAL_DAY_OF_YEAR,
	MCAL_DAY_OF_QTR,
	MCAL_DAY_OF_PERIOD,
	MCAL_DAY_OF_WEEK,
	W_CURRENT_MCAL_DAY_CODE,
	W_CURRENT_MCAL_PERIOD_CODE,
	W_CURRENT_MCAL_QTR_CODE,
	W_CURRENT_MCAL_WEEK_CODE,
	W_CURRENT_MCAL_YEAR_CODE,
	FST_DAY_MCAL_PER_FLG,
	FST_DAY_MCAL_QTR_FLG,
	FST_DAY_MCAL_WEEK_FLG,
	FST_DAY_MCAL_YEAR_FLG,
	LAST_DAY_MCAL_PER_FLG,
	LAST_DAY_MCAL_QTR_FLG,
	LAST_DAY_MCAL_WEEK_FLG,
	LAST_DAY_MCAL_YEAR_FLG,
	W_CAL_DAY_CODE,
	CAL_DAY_OF_THE_WEEK_ABBR,
	CAL_DAY_OF_THE_WEEK_CODE,
	CAL_DAY_OF_YEAR,
	CAL_DAY_OF_QTR,
	CAL_DAY_OF_MONTH,
	CAL_WEEK_WID,
	CAL_WEEK,
	CAL_WEEK_NAME,
	CAL_WEEK_START_DT,
	CAL_WEEK_START_DT_WID,
	CAL_WEEK_END_DT,
	CAL_WEEK_END_DT_WID,
	CAL_WEEK_ABBR,
	CAL_WEEK_OF_QTR,
	CAL_WEEK_TOTAL_DAYS,
	CAL_PRIOR_WEEK_WID,
	CAL_WEEK_AGO_WID,
	CAL_MONTH_WID,
	CAL_MONTH,
	W_CAL_MONTH_CODE,
	CAL_MONTH_START_DT,
	CAL_MONTH_START_DT_WID,
	CAL_MONTH_END_DT,
	CAL_MONTH_END_DT_WID,
	CAL_MONTH_ABBR,
	CAL_MONTH_OF_QTR,
	CAL_MONTH_TOTAL_DAYS,
	CAL_PRIOR_MONTH_WID,
	CAL_MONTH_AGO_WID,
	CAL_QTR_WID,
	CAL_QTR,
	CAL_QTR_ABBR,
	CAL_QTR_NAME,
	CAL_QTR_START_DT,
	CAL_QTR_START_DT_WID,
	CAL_QTR_END_DT,
	CAL_QTR_END_DT_WID,
	CAL_QTR_TOTAL_DAYS,
	CAL_PRIOR_QTR_WID,
	CAL_QTR_AGO_WID,
	CAL_DAY_AGO_DT,
	CAL_DAY_AGO_KEY,
	CAL_DAY_AGO_WID,
	CAL_HALF,
	CAL_TRIMESTER,
	CAL_JULIAN_DAY_NUM,
	CAL_JULIAN_MONTH_NUM,
	CAL_JULIAN_WEEK_NUM,
	CAL_JULIAN_TER_NUM,
	CAL_JULIAN_YEAR_NUM,
	CAL_YEAR_WID,
	CAL_YEAR,
	CAL_YEAR_NAME,
	CAL_YEAR_START_DT,
	CAL_YEAR_START_DT_WID,
	CAL_YEAR_END_DT,
	CAL_YEAR_END_DT_WID,
	CAL_YEAR_TOTAL_DAYS,
	CAL_PRIOR_YEAR_WID,
	FISCAL_DATE_WID,
	INTEGRATION_ID,
	FISCAL_CALENDAR_FLG,
	BUDGETARY_CALENDAR_FLG,
	DATASOURCE_NUM_ID,
	W_INSERT_DT,
	W_UPDATE_DT,
	TENANT_ID,
	X_CUSTOM,
	X_DIFF_FROM_CURRENT_PERIOD,
	X_YEAR_AGO_DT_WID
) as
    select 
    calendar_date ROW_WID,
    1 MCAL_CAL_WID,
	'HOT Calendar~1' MCAL_CAL_ID,
	'HOT Calendar' MCAL_CAL_NAME,
	'OLTP Sourced' MCAL_CAL_CLASS,
	day_code MCAL_DAY_CODE,
	calendar_date MCAL_DAY_DT,
	calendar_date MCAL_DAY_DT_WID,
	'N' ADJUSTMENT_PERIOD_FLG,
	ent_period_end_date MCAL_PERIOD_WID,
	'1' MCAL_PERIOD_TYPE,
	ent_period MCAL_PERIOD_NAME,
	ent_period_num MCAL_PERIOD,
	ent_period_start_date MCAL_PERIOD_START_DT,
	to_char(ent_period_start_date,'YYYYMMDD') MCAL_PERIOD_START_DT_WID,
	ent_period_end_date MCAL_PERIOD_END_DT,
	to_char(ent_period_end_date,'YYYYMMDD') MCAL_PERIOD_END_DT_WID,
	ent_period_ago_end_date MCAL_PRIOR_PERIOD_WID,
	ent_period_year_ago_end_date MCAL_PERIOD_AGO_WID,
	ent_period_num MCAL_PERIOD_OF_YEAR,
	ent_period_of_quarter MCAL_PERIOD_OF_QTR,
	ent_week MCAL_PERIOD_NAME_WEEK,
	to_char(ent_period_start_date,'YYYYMMDD') MCAL_PERIOD_START_DAY_WID ,
	to_char(ent_period_end_date,'YYYYMMDD') MCAL_PERIOD_END_DAY_WID,
	ent_year::int*100000 + ent_period_num*1000+ent_day_of_year MCAL_JULIAN_PERIOD_NUM,
	ent_week_start_date MCAL_WEEK_START_DT,
	ent_week_start_date MCAL_WEEK_START_DT_KEY,
	to_char(ent_week_start_date,'YYYYMMDD') MCAL_WEEK_START_DT_WID,
	ent_week_end_date MCAL_WEEK_END_DT,
	ent_week_end_date MCAL_WEEK_END_DT_KEY,
	to_char(ent_week_end_date,'YYYYMMDD') MCAL_WEEK_END_DT_WID,
	null MCAL_PRIOR_WEEK_WID,
	null MCAL_WEEK_AGO_WID,
	ent_week_num MCAL_WEEK_OF_YEAR,
	null MCAL_WEEK_OF_QTR,
	null MCAL_WEEK_OF_PERIOD,
	to_char(ent_week_start_date,'YYYYMMDD') MCAL_WEEK_START_DAY_WID,
	to_char(ent_week_end_date,'YYYYMMDD') MCAL_WEEK_END_DAY_WID,
	null MCAL_PER_NAME_HALF,
	null MCAL_PER_NAME_TER,
	ent_year::int*10 + ent_quarter_num MCAL_QTR_WID,
	ent_quarter_num MCAL_QTR,
	ent_quarter MCAL_PER_NAME_QTR,
    ent_quarter_start_date MCAL_QTR_START_DT,
	to_char(ent_quarter_start_date,'YYYYMMDD') MCAL_QTR_START_DT_WID,
	ent_quarter_end_date MCAL_QTR_END_DT,
	to_char(ent_quarter_end_date,'YYYYMMDD') MCAL_QTR_END_DT_WID,
	NULL MCAL_PRIOR_QTR_WID,
	null MCAL_QTR_AGO_WID,
	ent_quarter_num MCAL_QTR_OF_YEAR ,
	to_char(ent_quarter_start_date,'YYYYMMDD') MCAL_QTR_START_DAY_WID,
	to_char(ent_quarter_end_date,'YYYYMMDD') MCAL_QTR_END_DAY_WID,
	ent_year MCAL_YEAR_WID,
	ent_year MCAL_YEAR,
	ent_year MCAL_PER_NAME_YEAR,
	ent_year_start_date MCAL_YEAR_START_DT,
	to_char(ent_year_start_date, 'YYYYMMDD') MCAL_YEAR_START_DT_WID,
	ent_year_end_date MCAL_YEAR_END_DT,
	to_char(ent_year_start_date, 'YYYYMMDD') MCAL_YEAR_START_PERIOD_WID,
	to_char(ent_year_end_date, 'YYYYMMDD') MCAL_YEAR_END_DT_WID,
	ent_year_number_of_weeks MCAL_YEAR_TOTAL_WEEKS,
	ent_year_number_of_days MCAL_YEAR_TOTAL_DAYS,
	ent_prior_year MCAL_PRIOR_YEAR_WID,
	to_char(ent_year_start_date, 'YYYYMMDD') MCAL_YEAR_START_DAY_WID,
	to_char(ent_year_end_date, 'YYYYMMDD') MCAL_YEAR_END_DAY_WID,
	ent_day_of_year MCAL_DAY_OF_YEAR,
	null MCAL_DAY_OF_QTR,
	ent_day_of_period MCAL_DAY_OF_PERIOD,
	ent_day_of_week MCAL_DAY_OF_WEEK,
	current_cal_day_code W_CURRENT_MCAL_DAY_CODE,
	current_ent_period_code W_CURRENT_MCAL_PERIOD_CODE,
	current_ent_quarter_code W_CURRENT_MCAL_QTR_CODE,
	current_ent_week_code W_CURRENT_MCAL_WEEK_CODE,
	current_ent_year_code W_CURRENT_MCAL_YEAR_CODE,
	first_day_ent_period_flag FST_DAY_MCAL_PER_FLG,
	first_day_ent_quarter_flag FST_DAY_MCAL_QTR_FLG ,
	null FST_DAY_MCAL_WEEK_FLG ,
	first_day_ent_year_flag FST_DAY_MCAL_YEAR_FLG,
	last_day_ent_period_flag LAST_DAY_MCAL_PER_FLG,
	last_day_ent_quarter_flag LAST_DAY_MCAL_QTR_FLG,
	null LAST_DAY_MCAL_WEEK_FLG,
	last_day_ent_year_flag LAST_DAY_MCAL_YEAR_FLG,
	day_code W_CAL_DAY_CODE,
	day_code CAL_DAY_OF_THE_WEEK_ABBR,
	day_code CAL_DAY_OF_THE_WEEK_CODE,
	day_of_year CAL_DAY_OF_YEAR,
	null CAL_DAY_OF_QTR,
	day_of_month CAL_DAY_OF_MONTH,
	cal_week_dim_num CAL_WEEK_WID,
	cal_week_num CAL_WEEK,
	cal_week CAL_WEEK_NAME,
	cal_week_start_date CAL_WEEK_START_DT,
	to_char(cal_week_start_date,'YYYYMMDD') CAL_WEEK_START_DT_WID ,
	cal_week_end_date CAL_WEEK_END_DT,
	to_char(cal_week_end_date,'YYYYMMDD') CAL_WEEK_END_DT_WID,
	cal_week CAL_WEEK_ABBR,
	null CAL_WEEK_OF_QTR,
	null CAL_WEEK_TOTAL_DAYS,
	cal_prior_week_dim_num CAL_PRIOR_WEEK_WID,
	null CAL_WEEK_AGO_WID,
	cal_month_dim_num CAL_MONTH_WID,
	cal_month_num CAL_MONTH,
	current_cal_month_code W_CAL_MONTH_CODE,
	cal_month_start_date CAL_MONTH_START_DT,
	to_char(cal_month_start_date,'YYYYMMDD') CAL_MONTH_START_DT_WID,
	cal_month_end_date CAL_MONTH_END_DT,
	to_char(cal_month_end_date,'YYYYMMDD') CAL_MONTH_END_DT_WID,
	cal_month CAL_MONTH_ABBR,
	null CAL_MONTH_OF_QTR,
	cal_month_number_of_days CAL_MONTH_TOTAL_DAYS,
	cal_prior_month_dim_num CAL_PRIOR_MONTH_WID,
	cal_year_ago_month_dim_num CAL_MONTH_AGO_WID,
	cal_quarter_dim_num CAL_QTR_WID,
	cal_quarter_num CAL_QTR,
	cal_quarter CAL_QTR_ABBR,
	cal_quarter CAL_QTR_NAME,
	cal_quarter_start_date CAL_QTR_START_DT,
	to_char(cal_quarter_start_date,'YYYYMMDD') CAL_QTR_START_DT_WID,
	cal_quarter_end_date CAL_QTR_END_DT,
	to_char(cal_quarter_end_date,'YYYYMMDD') CAL_QTR_END_DT_WID,
	null CAL_QTR_TOTAL_DAYS,
	cal_prior_quarter_dim_num CAL_PRIOR_QTR_WID,
	null CAL_QTR_AGO_WID,
	day_ago_date CAL_DAY_AGO_DT,
	day_ago_date CAL_DAY_AGO_KEY,
	to_char(day_ago_date,'YYYYMMDD') CAL_DAY_AGO_WID,
	null CAL_HALF,
	null CAL_TRIMESTER,
	cal_year::int*1000+day_of_year CAL_JULIAN_DAY_NUM,
	cal_month_dim_num CAL_JULIAN_MONTH_NUM,
	cal_week_dim_num CAL_JULIAN_WEEK_NUM,
	null CAL_JULIAN_TER_NUM,
	cal_year CAL_JULIAN_YEAR_NUM,
	cal_year CAL_YEAR_WID,
	cal_year CAL_YEAR,
	cal_year CAL_YEAR_NAME,
	cal_year_start_date CAL_YEAR_START_DT,
	to_char(cal_year_start_date,'YYYYMMDD') CAL_YEAR_START_DT_WID,
	cal_year_end_date CAL_YEAR_END_DT,
	to_char(cal_year_end_date,'YYYYMMDD') CAL_YEAR_END_DT_WID,
	cal_year_number_of_days CAL_YEAR_TOTAL_DAYS,
	cal_prior_year CAL_PRIOR_YEAR_WID,
	to_char(calendar_date,'YYYYMMDD') FISCAL_DATE_WID,
	INTEGRATION_ID,
	'Y' FISCAL_CALENDAR_FLG,
	'Y' BUDGETARY_CALENDAR_FLG,
	DATASOURCE_NUM_ID,
	W_INSERT_DT,
	W_UPDATE_DT,
	'DEFAULT' TENANT_ID,
	null X_CUSTOM,
	distance_from_current_period X_DIFF_FROM_CURRENT_PERIOD,
	year_ago_date X_YEAR_AGO_DT_WID
    from test_edw.edw_omni.w_day_d
;